<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xmlns:h="http://java.sun.com/jsf/html" xmlns:p="http://primefaces.org/ui" xmlns:ui="http://java.sun.com/jsf/facelets" xmlns:f="http://java.sun.com/jsf/core" xmlns:util="http://java.sun.com/jsf/composite/util">
<h:head>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />

	<h:outputStylesheet library="css" name="styles.css" />
	<h:outputStylesheet library="css" name="grid.css" />
	<h:outputStylesheet library="css" name="bootstrap.css" />

	<h:outputScript name="utilities.js" library="javascript" target="head" />
	<script type="text/javascript">
		function openSurveillanceOrder(contextPath, id){
			openSurveillanceOrderView(contextPath, id);
			return false;
		}

		var mode;
		function getEmployee(contextPath){
			mode = 1;
			openEmpsMiniSearch(contextPath, 1);
			return false;
		}

		function getNonEmployee(contextPath){
			mode = 2;
			openNonEmpsMiniSearch(contextPath,1);
			return false;
	    }

		function getSurveillanceEmpNonEmp(contextPath, mode, empId, nonEmpId){
			mode = 3;
			openSurveillanceEmployeeDetails(contextPath, mode, empId, nonEmpId);
			return false;
		}
		
		function getRegionDepartment(contextPath,m){
	    	mode = 4;
			openDepartmentsMiniSearch(contextPath,m, null, '#{employeeAssignmentSearch.departmentType}');
			return false;
		}

		function getWorkflow(contextPath, instanceId){
            openWorkflowRepresentation(contextPath, 1, instanceId);
	      }
		
		function releaseMask(){
			unMaskScreen();
	   	}

		function HandlePopupResult(ret) {
		   	unMaskScreen();
			if(ret!=null){
				if(mode == 3){
					document.getElementById('survOrderSearchFormId:employeeSearchIdId').value=ret[0];
		         	document.getElementById('survOrderSearchFormId:employeeSearchNameId').innerHTML=ret[1];
				}else if (mode == 1){
					document.getElementById('survOrderSearchFormId:selectedEmployeeNonEmpNameId').value = ret[1];
	  		 		document.getElementById('survOrderSearchFormId:selectedEmployeeNonEmpSocialId').value = ret[2];
	  		 		document.getElementById('survOrderSearchFormId:empNonEmpNameId').innerHTML = ret[1];
	  		 		document.getElementById('survOrderSearchFormId:updateSearchFields').click();
				}else if (mode == 2){
					document.getElementById('survOrderSearchFormId:selectedEmployeeNonEmpNameId').value = ret[1];
					document.getElementById('survOrderSearchFormId:selectedEmployeeNonEmpSocialId').value = ret[2];
					document.getElementById('survOrderSearchFormId:empNonEmpNameId').innerHTML = ret[1];
					document.getElementById('survOrderSearchFormId:updateSearchFields').click();
				}
				else if (mode == 4){
					document.getElementById('survOrderSearchFormId:selectedDepartmentId').value = ret[0];
	   	         	document.getElementById('survOrderSearchFormId:selectedDepartmentNameId').value = ret[1];
	   	         	document.getElementById('survOrderSearchFormId:departmentNameId').innerHTML = ret[1];
				}
		        return true;
			}
			return false;
		}

		function handleDownloadFiles(e){
    		openDownloadPopupFlagId = document.getElementById('survOrderSearchFormId:openDownloadPopupFlagId').value;
    		openDownloadDialogueFlagId = document.getElementById('survOrderSearchFormId:openDownloadDialogueFlagId').value;
    		
    		if(e.status == 'success'){
    			if(openDownloadPopupFlagId == 'true'){
    				downloadFile();
        		}else if (openDownloadDialogueFlagId == 'true'){
        			PF('dlg').show();
            	}
    		}
        }

    	function downloadFile(){
    		downloadedFileParamId = document.getElementById('survOrderSearchFormId:downloadedFileParamId').value;
    		openDownloadFile('#{surveillanceOrdersSearch.boolServerDownloadPath}',downloadedFileParamId);
    		return false;
        }

		$(document).keypress(function (e){
			 if (e.which == 13 || e.keyCode == 13) {
 	        	document.getElementById('survOrderSearchFormId:searchBtnId').click();
 	        	event.preventDefault();
 	            return false;
 	        }
		});
	</script>
</h:head>
<h:body styleClass="screenBg">
	<h:form onsubmit="search();" id="survOrderSearchFormId" dir="#{msgs.dir}">
		<ui:decorate template="/Main/Template.xhtml">
			<table border="0" cellpadding="0" cellspacing="0" width="100%">
				<tr>
					<td class="screenTitle">#{msgs.title_surveillanceOrderSearch}</td>
				</tr>

				<tr>
					<td width="100%" height="5" />
				</tr>

				<tr>
					<td colspan="2">
						<table class="sectionTitle" border="0" cellpadding="0" cellspacing="0">
							<tr>
								<td>
									<h:outputText value="#{msgs.label_searchData}" />
								</td>
							</tr>
						</table>
					</td>
				</tr>

				<tr>
					<td width="100%" height="5" />
				</tr>

				<tr>
					<td>
						<h:panelGroup id="searchContainerId">
							<table class="sectionContent" border="0" cellpadding="0" cellspacing="0">
								<tr>
									<th width="15%">#{msgs.label_orderNo}</th>
									<td width="35%">
										<p:inputText id="orderNoSearchId" style=" direction: ltr; text-align: right; " styleClass="form-control inputnumber" maxlength="25" value="#{surveillanceOrdersSearch.searchSurvEmployee.orderNumber}" />
									</td>
									<th width="15%">#{msgs.label_orderDate}</th>
									<td width="35%">
										<util:advancedHijriDate id="orderDateId" value="#{surveillanceOrdersSearch.searchSurvEmployee.orderDate}" />
									</td>
								</tr>

								<tr>
									<th width="15%">#{msgs.label_departmentFinalApproval}</th>
									<td width="35%">
										<h:selectOneMenu class="form-control inputnumber" value="#{surveillanceOrdersSearch.searchSurvEmployee.finalApprovalEntity}">
											<f:selectItem itemValue="" itemLabel=" " />
											<f:selectItems value="#{surveillanceOrdersSearch.finalApprovalList}" var="f" itemLabel="#{f.code}" itemValue="#{f.code}" />
										</h:selectOneMenu>
									</td>
									<th width="15%">
										#{msgs.label_region}
										<h:commandButton rendered="#{surveillanceOrdersSearch.searchSurvEmployee.regionId == null || surveillanceOrdersSearch.searchSurvEmployee.regionId == surveillanceOrdersSearch.headQuarter}" value="&#xf002;" styleClass="btn btn-trans-icon" onclick="return getRegionDepartment('#{request.contextPath}',2);" title="#{msgs.label_addDepartment}" />
									</th>
									<td width="35%">
										<h:inputHidden id="selectedDepartmentId" value="#{surveillanceOrdersSearch.searchSurvEmployee.regionId}" />
										<h:inputHidden id="selectedDepartmentNameId" value="#{surveillanceOrdersSearch.searchSurvEmployee.regionName}" />
										<h:outputText id="departmentNameId" value="#{surveillanceOrdersSearch.searchSurvEmployee.regionName}" />
									</td>
								</tr>

								<tr>
									<th width="15%">#{msgs.label_empNonEmp}</th>
									<td width="35%">
										<h:selectOneMenu class="form-control inputnumber" value="#{surveillanceOrdersSearch.employeeFlag}">
											<f:selectItem itemValue="#{null}" itemLabel="" />
											<f:selectItem itemValue="true" itemLabel="#{msgs.label_employeeTitle}" />
											<f:selectItem itemValue="false" itemLabel="#{msgs.label_nonEmpTitle}" />
											<f:ajax execute="survOrderSearchFormId:searchContainerId" render="survOrderSearchFormId:searchContainerId" listener="#{surveillanceOrdersSearch.onSelectionChange()}" />
										</h:selectOneMenu>
										<h:commandButton styleClass="btn btn-trans-icon" value="&#xf002;" onclick="return getEmployee('#{request.contextPath}');" rendered="#{not empty surveillanceOrdersSearch.employeeFlag and surveillanceOrdersSearch.employeeFlag}" />
										<h:commandButton styleClass="btn btn-trans-icon" value="&#xf002;" onclick="return getNonEmployee('#{request.contextPath}');" rendered="#{not empty surveillanceOrdersSearch.employeeFlag and not surveillanceOrdersSearch.employeeFlag}" />
										<h:inputHidden id="selectedEmployeeNonEmpNameId" value="#{surveillanceOrdersSearch.searchSurvEmployee.employeeFullName}" />
										<h:inputHidden id="selectedEmployeeNonEmpSocialId" value="#{surveillanceOrdersSearch.searchSurvEmployee.socialId}" />
										<h:outputText id="empNonEmpNameId" value="#{surveillanceOrdersSearch.searchSurvEmployee.employeeFullName}" rendered="#{not empty surveillanceOrdersSearch.employeeFlag}" />
										<h:commandButton id="updateSearchFields" style="display : none;">
											<f:ajax execute="survOrderSearchFormId:searchContainerId" render="survOrderSearchFormId:searchContainerId" />
										</h:commandButton>
									</td>
									<th width="15%">#{msgs.label_socialNumber}</th>
									<td width="35%">
										<h:inputText styleClass="form-control inputnumber" disabled="true" id="survSocialId" value="#{surveillanceOrdersSearch.searchSurvEmployee.socialId}" />
									</td>
								</tr>

								<tr>
									<th width="15%">#{msgs.label_surveillanceStatus}</th>
									<td width="35%">
										<h:selectOneMenu class="form-control inputnumber" value="#{surveillanceOrdersSearch.surveillanceStatus}">
											<f:selectItem noSelectionOption="true" itemValue="-1" itemLabel="#{msgs.label_all}" />
											<f:selectItem itemValue="1" itemLabel="#{msgs.label_surveillanceRunning}" />
											<f:selectItem itemValue="0" itemLabel="#{msgs.label_surveillanceStopped}" />
										</h:selectOneMenu>
									</td>
									<th width="15%">#{msgs.label_lateReports}</th>
									<td width="20%" colspan="1">
										<h:selectBooleanCheckbox value="#{surveillanceOrdersSearch.lateReports}" />
									</td>
								</tr>
							</table>
						</h:panelGroup>
					</td>
				</tr>

				<tr>
					<td width="100%" height="5" />
				</tr>

				<tr>
					<td width="100%">
						<table class="actionsSection" border="0" cellpadding="0" cellspacing="0">
							<tr>
								<td>
									<h:commandButton styleClass="btn btn-default" id="resetBtnId" value="&#xf021; #{msgs.label_reset}" action="#{surveillanceOrdersSearch.init()}">
										<f:ajax render="survOrderSearchFormId:searchContainerId" />
									</h:commandButton>
									<h:commandButton styleClass="btn btn-default" id="searchBtnId" value="&#xf002; #{msgs.label_search}" action="#{surveillanceOrdersSearch.searchSurveillanceEmployee()}">
										<f:ajax render="survOrderSearchFormId:survOrderViewPaneId survOrderSearchFormId:actionsPaneId survOrderSearchFormId:reportsPaneId" execute="survOrderSearchFormId:searchContainerId" />
									</h:commandButton>
								</td>
							</tr>
						</table>
					</td>
				</tr>

				<tr>
					<td width="100%" height="5" />
				</tr>

				<tr>
					<td>
						<table class="sectionTitle" border="0" cellpadding="0" cellspacing="0">
							<tr>
								<td>
									<h:outputText value="#{msgs.label_searchData}" />
								</td>
							</tr>
						</table>
					</td>
				</tr>

				<tr>
					<td width="100%" height="5" />
				</tr>

				<tr>
					<td align="center" width="100%">
						<h:panelGroup id="survOrderViewPaneId">
							<p:dataTable reflow="true" tableStyle="table-layout: auto" paginator="true" id="survOrderListDataTableId" rows="#{surveillanceOrdersSearch.rowsCount}" rowIndexVar="index" var="row" value="#{surveillanceOrdersSearch.surveillanceEmployeeList}" rowHover="true">
								<p:column styleClass='centerText'>
									<f:facet name="header">#</f:facet>
	                                #{index + 1}
	                            </p:column>
								<p:column styleClass='centerText'>
									<f:facet name="header"> #{msgs.label_socialNumber} </f:facet>
									<h:outputText id="socialIdViewId" value="#{row.socialId}" />
								</p:column>
								<p:column styleClass='centerText'>
									<f:facet name="header"> #{msgs.label_name} </f:facet>
									<h:outputText id="fullNameViewId" value="#{row.employeeFullName}" />
								</p:column>
								<p:column styleClass='centerText'>
									<f:facet name="header"> #{msgs.label_rank} </f:facet>
									<h:outputText id="rankViewId" value="#{row.rank}" />
								</p:column>
								<p:column styleClass='centerText'>
									<f:facet name="header"> #{msgs.label_birthDate} </f:facet>
									<h:outputText id="birthDateId" value="#{row.birthDateString}" />
								</p:column>
								<p:column styleClass='centerText'>
									<f:facet name="header"> #{msgs.label_orderNo} </f:facet>
									<h:outputText id="orderNumberViewId" value="#{row.orderNumber}" />
								</p:column>
								<p:column styleClass='centerText'>
									<f:facet name="header"> #{msgs.label_orderDate} </f:facet>
									<h:outputText id="orderDateViewId" value="#{row.orderDateString}" />
								</p:column>
								<p:column styleClass='centerText'>
									<f:facet name="header"> #{msgs.label_surveillanceStartDate} </f:facet>
									<h:outputText id="startDateViewId" value="#{row.startDateString}" />
								</p:column>
								<p:column styleClass='centerText'>
									<f:facet name="header"> #{msgs.label_surveillanceEndDate} </f:facet>
									<h:outputText id="endDateViewId" value="#{row.endDateString}" />
								</p:column>
								<p:column styleClass='centerText'>
									<f:facet name="header"> #{msgs.label_surveillanceInstanceStatus} </f:facet>
									<h:outputText rendered="#{row.wFInstanceStatus == null}" value="#{msgs.label_underProcess}" />
									<h:outputText rendered="#{row.wFInstanceStatus == surveillanceOrdersSearch.wfInstanceRejectedEnum}" value="#{msgs.label_rejected}" />
									<h:outputText rendered="#{row.wFInstanceStatus == surveillanceOrdersSearch.wfInstanceCompleteEnum}" value="#{msgs.label_approved}" />
									<h:outputText rendered="#{row.wFInstanceStatus == surveillanceOrdersSearch.wfInstanceRunningEnum}" value="#{msgs.label_underApproval}" />
								</p:column>
								<p:column styleClass='centerText'>
									<f:facet name="header"> #{msgs.label_surveillanceRegionName} </f:facet>
									<h:outputText id="regionNameViewId" value="#{row.orderRegionName}" />
								</p:column>
								<p:column styleClass='centerText'>
									<f:facet name="header"> #{msgs.label_surveillanceEmployeeInfo} </f:facet>
									<h:commandButton rendered="#{row.wFInstanceStatus.equals(surveillanceOrdersSearch.wfInstanceCompleteEnum)}" value="&#xf05a;" styleClass="btn btn-trans-icon" id="surveillanceEmployeeInfoBtnId" onclick="return getSurveillanceEmpNonEmp('#{request.contextPath}', 1, '#{row.employeeId}', '#{row.nonEmployeeId}');" />
								</p:column>
								<p:column styleClass='centerText'>
									<f:facet name="header"> #{msgs.label_surveillanceActionsReports} </f:facet>
									<h:commandButton rendered="#{row.wFInstanceStatus.equals(surveillanceOrdersSearch.wfInstanceCompleteEnum)}" id="viewActionsId" value="&#xf05a;" styleClass="btn btn-trans-icon" action="#{surveillanceOrdersSearch.viewSurveillanceActionsAndReports(row)}">
										<f:ajax render="survOrderSearchFormId:notifyMessagesId survOrderSearchFormId:actionsPaneId survOrderSearchFormId:reportsPaneId" execute="survOrderSearchFormId:survOrderViewPaneId" />
									</h:commandButton>
								</p:column>
								<p:column styleClass='centerText'>
									<f:facet name="header"> #{msgs.label_surveillanceDetails} </f:facet>
									<h:commandButton onclick="openSurveillanceOrder('#{request.contextPath}',#{row.surveillanceOrderId});" id="surveillanceDetailsBtnId" value="&#xf05a;" styleClass="btn btn-trans-icon" action="#{surveillanceOrdersSearch.refreshSubmit()}">
										<f:ajax></f:ajax>
									</h:commandButton>
								</p:column>
								<p:column styleClass='centerText'>
									<f:facet name="header"> #{msgs.label_edit} </f:facet>
									<h:commandButton rendered="#{row.wFInstanceStatus == null}" id="viewOrderDetailsId" value="&#xf14b;" styleClass="btn btn-trans-icon" action="#{surveillanceOrdersSearch.editSurveillanceDetail(row.surveillanceOrderId)}">
									</h:commandButton>
								</p:column>
								<p:column styleClass='centerText'>
									<f:facet name="header"> #{msgs.label_archiveDocumentsShow} </f:facet>
									<h:commandButton styleClass="btn btn-success" value="&#xf0c5; #{msgs.label_archiveDocumentsShow}">
										<f:ajax render="survOrderSearchFormId:downloadDlgPanelId survOrderSearchFormId:openDownloadDialogueFlagId survOrderSearchFormId:openDownloadPopupFlagId survOrderSearchFormId:downloadedFileParamId" listener="#{surveillanceOrdersSearch.getDownloadedAttachmentsIdList(row.surveillanceOrderId)}" onevent="handleDownloadFiles" />
									</h:commandButton>
								</p:column>
								<p:column>
									<f:facet name="header">
										<h:outputText value="#{msgs.label_workFlowProgress}" />
									</f:facet>
									<p:commandButton value="&#xf03a;" rendered="#{row.wFInstanceId != null}" styleClass="btn btn-trans-icon" onclick="getWorkflow('#{request.contextPath}', '#{row.wFInstanceId}'); return false;" />
								</p:column>
							</p:dataTable>
						</h:panelGroup>
					</td>
				</tr>

				<tr>
					<td width="100%" height="5" />
				</tr>

				<tr>
					<td>
						<h:panelGroup id="actionsPaneId">
							<h:panelGroup rendered="#{not empty surveillanceOrdersSearch.selectedEmployee}">
								<table width="100%">
									<tr>
										<td>
											<table class="sectionTitle" border="0" cellpadding="0" cellspacing="0">
												<tr>
													<td>
														<h:outputText value="#{msgs.label_surveillanceActions}" />
													</td>
												</tr>
											</table>
										</td>
									</tr>

									<tr>
										<td width="100%" height="5" />
									</tr>

									<tr>
										<td>
											<p:fieldset toggleable="true" id="actionsSavePaneId" legend="#{msgs.label_insertEdit}" collapsed="#{not surveillanceOrdersSearch.actionCollapsFlag}">
												<table width="100%">
													<tr>
														<td>
															<table class="sectionContent" border="0" cellpadding="0" cellspacing="0" width="100%">
																<tr>
																	<th width="15%">
																		#{msgs.label_eventDate}
																		<h:outputText value="*" style="color:red;" />
																	</th>
																	<td width="35%">
																		<util:advancedHijriDate id="actionDateEditId" value="#{surveillanceOrdersSearch.surveillanceAction.eventDate}" />
																	</td>

																	<th width="15%">
																		#{msgs.label_eventDetails}
																		<h:outputText value="*" style="color:red;" />
																	</th>
																	<td width="35%">
																		<h:inputTextarea styleClass="form-control" id="actionDetailsEditId" style="width: 90%;" value="#{surveillanceOrdersSearch.surveillanceAction.eventDetails}" />
																	</td>
																</tr>
																<tr>
																	<th width="15%">
																		#{msgs.label_questionClass}
																		<h:outputText value="*" style="color:red;" />
																	</th>
																	<td width="35%">
																		<h:selectOneMenu styleClass="form-control inputnumber" style="width:50%" value="#{surveillanceOrdersSearch.surveillanceAction.classCode}">
																			<f:selectItem itemLabel="#{msgs.label_behavioralAspects}" itemValue="SURVEILLANCE_BEHAVIOURAL_EVALUATION_POINT" />
																			<f:selectItem itemLabel="#{msgs.label_functionalAspects}" itemValue="SURVEILLANCE_FUNCTIONAL_EVALUATION_POINT" />
																			<f:ajax render="survOrderSearchFormId:actionsSavePaneId" execute="survOrderSearchFormId:actionsSavePaneId" listener="#{surveillanceOrdersSearch.changeSurveillanceActionEvalPoint()}" />
																		</h:selectOneMenu>
																	</td>

																	<th width="15%">
																		#{msgs.label_question}
																		<h:outputText value="*" style="color:red;" />
																	</th>
																	<td>
																		<h:selectOneMenu styleClass="form-control inputnumber" style="width:80%" value="#{surveillanceOrdersSearch.surveillanceAction.evalPointDomainId}">
																			<f:selectItems value="#{surveillanceOrdersSearch.evalPointList}" var="evalPoint" itemLabel="#{evalPoint.description}" itemValue="#{evalPoint.id}" />
																		</h:selectOneMenu>
																	</td>
																</tr>
															</table>
														</td>
													</tr>

													<tr>
														<td>
															<table class="actionsSection" border="0" cellpadding="0" cellspacing="0" width="100%">
																<tr>
																	<td width="100%">
																		<h:commandButton id="saveBtnId" styleClass="btn btn-success" action="#{surveillanceOrdersSearch.saveAction()}" value="#{msgs.label_save}" onclick="return confirm('#{msgs.q_save}');">
																			<f:ajax render="survOrderSearchFormId:actionsSavePaneId survOrderSearchFormId:actionsViewPaneId survOrderSearchFormId:notifyMessagesId" execute="survOrderSearchFormId:actionsSavePaneId" />
																		</h:commandButton>
																		<h:commandButton id="cancelBtnId" styleClass="btn btn-default" value="#{msgs.label_cancel}" action="#{surveillanceOrdersSearch.cancelAction()}">
																			<f:ajax render="survOrderSearchFormId:actionsSavePaneId survOrderSearchFormId:notifyMessagesId" />
																		</h:commandButton>
																	</td>
																</tr>
															</table>
														</td>
													</tr>
												</table>
											</p:fieldset>
										</td>
									</tr>

									<tr>
										<td width="100%" height="5" />
									</tr>

									<tr>
										<td align="center" width="100%">
											<h:panelGroup id="actionsViewPaneId">
												<p:dataTable reflow="true" tableStyle="table-layout: auto" paginator="true" id="actionsListDataTableId" rows="#{surveillanceOrdersSearch.rowsCount}" rowIndexVar="index" var="row" value="#{surveillanceOrdersSearch.surveillanceActionList}" rowHover="true">
													<p:column styleClass='centerText'>
														<f:facet name="header">#</f:facet>
						                                #{index + 1}
						                            </p:column>
													<p:column styleClass='centerText'>
														<f:facet name="header"> #{msgs.label_eventDate} </f:facet>
														<h:outputText id="actionDateViewId" value="#{row.eventDateString}" />
													</p:column>
													<p:column styleClass='centerText'>
														<f:facet name="header"> #{msgs.label_eventDetails} </f:facet>
														<h:outputText id="eventDetailsViewId" value="#{row.eventDetails}" />
													</p:column>
													<p:column styleClass='centerText'>
														<f:facet name="header"> #{msgs.label_questionClass} </f:facet>
														<h:outputText id="questionClassViewId" value="#{row.classDescription}" />
													</p:column>
													<p:column styleClass='centerText'>
														<f:facet name="header"> #{msgs.label_question} </f:facet>
														<h:outputText id="questionViewId" value="#{row.domainDescription}" />
													</p:column>
													<p:column styleClass='centerText' style="width:20%;">
														<f:facet name="header"> #{msgs.label_edit} </f:facet>
														<h:commandButton id="editActionBtnId" value="&#xf044;" styleClass="btn btn-trans-icon" action="#{surveillanceOrdersSearch.editSurveillanceAction(row)}">
															<f:ajax render="survOrderSearchFormId:notifyMessagesId survOrderSearchFormId:actionsSavePaneId" />
														</h:commandButton>
													</p:column>
													<p:column styleClass='centerText' style="width:20%;">
														<f:facet name="header"> #{msgs.label_delete} </f:facet>
														<h:commandButton id="deleteActionBtnId" value="&#xf00d;" styleClass="btn btn-trans-icon" action="#{surveillanceOrdersSearch.deleteSurveillanceAction(row)}" onclick="return confirm('#{msgs.q_delete}');">
															<f:ajax render="survOrderSearchFormId:notifyMessagesId survOrderSearchFormId:actionsViewPaneId survOrderSearchFormId:actionsSavePaneId" />
														</h:commandButton>
													</p:column>
												</p:dataTable>
											</h:panelGroup>
										</td>
									</tr>
								</table>
							</h:panelGroup>
						</h:panelGroup>
					</td>
				</tr>

				<tr>
					<td width="100%" height="5" />
				</tr>

				<tr>
					<td>
						<h:panelGroup id="reportsPaneId">
							<h:panelGroup rendered="#{not empty surveillanceOrdersSearch.selectedEmployee}">
								<table width="100%">
									<tr>
										<td>
											<table class="sectionTitle" border="0" cellpadding="0" cellspacing="0">
												<tr>
													<td>
														<h:outputText value="#{msgs.label_reports}" />
													</td>
												</tr>
											</table>
										</td>
									</tr>

									<tr>
										<td width="100%" height="5" />
									</tr>

									<tr>
										<td>
											<p:fieldset toggleable="true" id="reportsSavePaneId" legend="#{msgs.label_insert}" collapsed="#{not surveillanceOrdersSearch.reportCollapsFlag}">
												<table width="100%">
													<tr>
														<td>
															<table class="sectionContent" border="0" cellpadding="0" cellspacing="0" width="100%">
																<tr>
																	<th width="15%">
																		#{msgs.label_reportDurationFrom}
																		<h:outputText value="*" style="color:red;" />
																	</th>
																	<td width="35%">
																		<util:advancedHijriDate value="#{surveillanceOrdersSearch.startDate}" />
																	</td>

																	<th width="15%">
																		#{msgs.label_to}
																		<h:outputText value="*" style="color:red;" />
																	</th>
																	<td width="35%">
																		<util:advancedHijriDate value="#{surveillanceOrdersSearch.endDate}" />
																	</td>
																</tr>
															</table>
														</td>
													</tr>

													<tr>
														<td>
															<table class="actionsSection" border="0" cellpadding="0" cellspacing="0" width="100%">
																<tr>
																	<td width="100%">
																		<h:commandButton styleClass="btn btn-success" action="#{surveillanceOrdersSearch.addSurveillanceReport()}" value="#{msgs.label_save}" onclick="return confirm('#{msgs.q_save}');">
																			<f:ajax render="survOrderSearchFormId:reportsSavePaneId survOrderSearchFormId:reportsListDataTableId survOrderSearchFormId:notifyMessagesId" execute="survOrderSearchFormId:reportsSavePaneId" />
																		</h:commandButton>
																		<h:commandButton styleClass="btn btn-default" value="#{msgs.label_cancel}" action="#{surveillanceOrdersSearch.cancelReport()}">
																			<f:ajax render="survOrderSearchFormId:reportsSavePaneId survOrderSearchFormId:notifyMessagesId" />
																		</h:commandButton>
																	</td>
																</tr>
															</table>
														</td>
													</tr>
												</table>
											</p:fieldset>
										</td>
									</tr>

									<tr>
										<td width="100%" height="5" />
									</tr>

									<tr>
										<td align="center" width="100%">
											<h:panelGroup id="reportViewPaneId">
												<p:dataTable reflow="true" tableStyle="table-layout: auto" paginator="true" id="reportsListDataTableId" rows="#{surveillanceOrdersSearch.rowsCount}" rowIndexVar="index" var="row" value="#{surveillanceOrdersSearch.surveillanceReportList}" rowHover="true">
													<p:column styleClass='centerText'>
														<f:facet name="header">#</f:facet>
						                                #{index + 1}
						                            </p:column>
													<p:column styleClass='centerText'>
														<f:facet name="header"> #{msgs.label_reportStartDate} </f:facet>
														<h:outputText id="reportStartDateViewId" value="#{row.startDateString}" />
													</p:column>
													<p:column styleClass='centerText'>
														<f:facet name="header"> #{msgs.label_reportEndDate} </f:facet>
														<h:outputText id="reportEndDateViewId" value="#{row.endDateString}" />
													</p:column>
													<p:column styleClass='centerText'>
														<f:facet name="header"> #{msgs.label_recommendation} </f:facet>
														<h:outputText id="continueSurveillanceViewId" value="#{msgs.label_continueSurveillance}" rendered="#{row.recommendationDecisionType == 0}" />
														<h:outputFormat id="extendSurveillanceViewId" value="#{msgs.label_extendSurveillance}" rendered="#{row.recommendationDecisionType == 1}">
															<f:param value="#{row.recommendationPeriod}" />
														</h:outputFormat>
														<h:outputText id="endSurveillanceViewId" value="#{msgs.label_endSurveillance}" rendered="#{row.recommendationDecisionType == 2}" />
													</p:column>
													<p:column styleClass='centerText'>
														<f:facet name="header"> #{msgs.label_reportState} </f:facet>
														<h:outputText id="approvedId" value="#{msgs.label_approved}" rendered="#{row.approved == 1}" />
														<h:outputText id="inProgressId" value="#{msgs.label_inProgress}" rendered="#{row.approved == 0 and empty row.wFInstanceId}" />
														<h:outputText id="underApprovalId" value="#{msgs.label_underApproval}" rendered="#{row.approved == 0 and not empty row.wFInstanceId}" />
													</p:column>
													<p:column styleClass='centerText' style="width:20%;">
														<f:facet name="header"> #{msgs.label_viewEdit} </f:facet>
														<h:commandButton id="editReportBtnId" value="&#xf044;" styleClass="btn btn-trans-icon" action="#{surveillanceOrdersSearch.viewReportDetail(row.id)}" />
													</p:column>
												</p:dataTable>
											</h:panelGroup>
										</td>
									</tr>
								</table>
							</h:panelGroup>
						</h:panelGroup>
					</td>
				</tr>
			</table>
			<h:panelGroup id="downloadDlgPanelId">
				<p:dialog dir="#{msgs.dir}" header="#{msgs.label_archiveDocumentsShow}" id="dlgId" widgetVar="dlg" modal="true" height="180px;" width="720px">
					<h:panelGroup id="internalDlgPanelId">
						<table width="100%">
							<tr>
								<td>
									<p:dataTable tableStyle="table-layout:auto" reflow="true" liveResize="true" paginatorPosition="bottom" id="fileListIds" paginator="true" style="width:100%" rowIndexVar="index" rows="10" var="row" value="#{surveillanceOrdersSearch.attachmentList}" widgetVar="table" rowHover="true">
										<p:column styleClass='centerText'>
											<f:facet name="header">#</f:facet>
		                                    #{index + 1}
	                                   	</p:column>
										<p:column styleClass='centerText'>
											<f:facet name="header">
													#{msgs.label_fileName}
												</f:facet>
											<h:outputText value="#{row.fileName}" />
										</p:column>
										<p:column styleClass='centerText'>
											<f:facet name="header">
												#{msgs.label_download}
											</f:facet>
											<h:commandButton styleClass="btn btn-success" value="&#xf019; #{msgs.label_download}">
												<f:ajax render="survOrderSearchFormId:internalDlgPanelId survOrderSearchFormId:downloadedFileParamId" listener="#{surveillanceOrdersSearch.getDownloadParam(row.attachmentId)}" onevent="function(e){if(e.status == 'success') return downloadFile();}" />
											</h:commandButton>
										</p:column>
										<p:column styleClass='centerText' rendered="#{surveillanceOrdersSearch.deletePrivilage}">
											<f:facet name="header">
												#{msgs.label_delete}
											</f:facet>
											<h:commandButton styleClass="btn btn-trans-icon" value="&#xf00d;">
												<f:ajax render="survOrderSearchFormId:internalDlgPanelId survOrderSearchFormId:downloadedFileParamId" listener="#{surveillanceOrdersSearch.deleteAttachment(row)}" />
											</h:commandButton>
										</p:column>
									</p:dataTable>
								</td>
							</tr>
						</table>
					</h:panelGroup>
				</p:dialog>
				<h:inputHidden id="downloadedFileParamId" value="#{surveillanceOrdersSearch.downloadFileParamId}" />
				<h:inputHidden id="openDownloadPopupFlagId" value="#{surveillanceOrdersSearch.openDownloadPopupFlag}" />
				<h:inputHidden id="openDownloadDialogueFlagId" value="#{surveillanceOrdersSearch.openDownloadDialogueFlag}" />
			</h:panelGroup>
		</ui:decorate>
	</h:form>
</h:body>
</html>