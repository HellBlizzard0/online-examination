<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xmlns:h="http://java.sun.com/jsf/html" xmlns:p="http://primefaces.org/ui" xmlns:ui="http://java.sun.com/jsf/facelets" xmlns:f="http://java.sun.com/jsf/core" xmlns:util="http://java.sun.com/jsf/composite/util" xmlns:code="http://java.sun.com/jsf/composite/code">
<h:head>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	<h:outputStylesheet library="css" name="styles.css" />
	<h:outputStylesheet library="css" name="grid.css" />
	<h:outputStylesheet library="css" name="bootstrap.css" />
	<h:outputStylesheet library="css" name="buttonStyle.css" />
	<h:outputStylesheet library="css" name="dateRangePicker.css" />
	<h:outputScript name="utilities.js" library="javascript" target="head" />
	<script type="text/javascript">
		function expandClassificationTypeFieldSet(e) {
			if (e.status == 'success') {
				$(document.getElementById('conversationRegFormId:conversationWizardPanelId')).children('.ui-fieldset-content').css({
					'display' : 'block'
				});
			}
		}

		function collapseClassificationTypeFieldSet(e) {
			if (e.status == 'success') {
				$(document.getElementById('conversationRegFormId:conversationWizardPanelId')).children('.ui-fieldset-content').css({
					'display' : 'none'
				});
			}
		}

		var m;
		function getFollowUp(contextPath) {
			m = 1;
			openFollowUpMiniSearch(contextPath, "true");
			return false;
		}
		function getReferralSearch(contextPath) {
			m = 2;
			openInsertReferralMiniSearch(contextPath);
			return false;
		}
		function getConversationParty(contextPath) {
			m = 3;
			openConversationPartiesMiniSearch(contextPath);
			return false;
		}
		function getReminder(contextPath) {
			m = 4;
			openReminderMiniSearch(contextPath);
			return false;
		}
		function HandlePopupResult(ret) {
			unMaskScreen();
			if (ret != null) {
				if (m == 1) {
					document.getElementById('conversationRegFormId:followUpIdId').value = ret[0];
					document.getElementById('conversationRegFormId:followUpCodeId').value = ret[1];
					document.getElementById('conversationRegFormId:followUpCodeViewId').innerHTML = ret[1];
					document.getElementById('conversationRegFormId:followUpCodeViewId').value = ret[1];
					document.getElementById('conversationRegFormId:renderConversationWizardBtnId').click();
					return true;
				} else if (m == 2) {
					document.getElementById('conversationRegFormId:domainIdReferralTypeId').value = ret[0];
					document.getElementById('conversationRegFormId:domainIdReferralTypeDesId').value = ret[1];
					document.getElementById('conversationRegFormId:employeeNumberId').value = ret[2];
					document.getElementById('conversationRegFormId:employeeNameId').value = ret[3];
					document.getElementById('conversationRegFormId:referralDataDetailsId').value = ret[4];
					document.getElementById('conversationRegFormId:referralDataHiddenBtnId').click();
					return true;
				} else if (m == 3) {
					document.getElementById('conversationRegFormId:selectedConvPartyContactNumberId').value = ret[0];
					document.getElementById('conversationRegFormId:selectedConvPartyNameId').value = ret[1];
					document.getElementById('conversationRegFormId:selectedConvPartyFollowUpCodeId').value = ret[2];
					document.getElementById('conversationRegFormId:selectedConvPartyNetworkRoleId').value = ret[3];
					document.getElementById('conversationRegFormId:selectedConvPartyNetworkRoleDescId').value = ret[4];
					document.getElementById('conversationRegFormId:conversationPartyHiddenBtnId').click();
					return true;
				} else if (m == 4) {
					document.getElementById('conversationRegFormId:reminderDateId').value = ret[0] + '/' + ret[1] + '/' + ret[2];
					document.getElementById('conversationRegFormId:reminderTimeId').value = ret[3];
					document.getElementById('conversationRegFormId:reminderDetailsId').value = ret[4];

					document.getElementById('conversationRegFormId:reminderHiddenBtnId').click();
					return true;
				}
			}
			return false;
		}
		function validateTime(t) {
			var time = document.getElementById("conversationRegFormId:conversationTimeId");
			var min = time.value.substring(0, 2);
			var sec = time.value.substring(3, 5);
			/* <![CDATA[ */
			if (min != parseInt(min) || sec != parseInt(sec) || parseInt(min) > 23 || parseInt(sec) > 59) {
				time.value = "";
				return false;
			}
			/* ]]> */
			return true;
		}
		function releaseMask() {
			unMaskScreen();
		}

		function handleDownloadFiles(e) {
			openDownloadPopupFlagId = document.getElementById('conversationRegFormId:openDownloadPopupFlagId').value;
			openDownloadDialogueFlagId = document.getElementById('conversationRegFormId:openDownloadDialogueFlagId').value;

			if (e.status == 'success') {
				if (openDownloadPopupFlagId == 'true') {
					downloadFile();
				} else if (openDownloadDialogueFlagId == 'true') {
					PF('dlg').show();
				}
			}
		}

		function uploadFile() {
			fileArchivingParam = document.getElementById('conversationRegFormId:fileArchivingParamId').value;
			openUploadFile('#{conversationRegisteration.boolServerUploadPath}', fileArchivingParam);
			return false;
		}

		function downloadFile() {
			downloadedFileParamId = document.getElementById('conversationRegFormId:downloadedFileParamId').value;
			openDownloadFile('#{conversationRegisteration.boolServerDownloadPath}', downloadedFileParamId);
			return false;
		}
	</script>
</h:head>
<h:body styleClass="screenBg">
	<h:form id="conversationRegFormId" dir="#{msgs.dir}">
		<ui:decorate template="/Main/Template.xhtml">
			<table border="0" cellpadding="0" cellspacing="0" width="100%">
				<tr>
					<td width="100%" height="5" />
				</tr>

				<tr>
					<td class="screenTitle">
						<h:outputText value="#{msgs.title_converstaionsRegistration}" />
					</td>
				</tr>

				<tr>
					<td width="100%" height="10" />
				</tr>
				<tr>
					<td colspan="2">
						<table class="sectionTitle" border="0" cellpadding="0" cellspacing="0">
							<tr>
								<td>
									<h:outputText value="#{msgs.label_followSelect}" />
								</td>
							</tr>
						</table>
					</td>
				</tr>
				<tr>
					<td>
						<h:panelGroup id="followUpContainerId">
							<table class="sectionContent" border="0" cellpadding="0" cellspacing="0" style="width: 50%;">
								<tr>
									<th>
										<h:outputText value="#{msgs.label_followUp}" />
										<h:outputText value="*" style="color:red;" />
									</th>
									<td>
										<h:inputText disabled="true" id="followUpCodeViewId" value="#{conversationRegisteration.conversationData.followUpCode}" style="width:88%;" />

										<h:panelGroup rendered="#{conversationRegisteration.pageMode == 2 and conversationRegisteration.allowFollowUpUpdate}">
											<h:commandButton value="&#xf03a;" styleClass="btn btn-trans-icon" onclick="return getFollowUp('#{request.contextPath}');" />
											<h:inputHidden id="followUpIdId" value="#{conversationRegisteration.conversationData.followUpId}" />
											<h:inputHidden id="followUpCodeId" value="#{conversationRegisteration.conversationData.followUpCode}" />
											<h:commandButton id="renderConversationWizardBtnId" style="display : none ;" action="#{conversationRegisteration.refreshSubmit()}">
												<f:ajax execute="conversationRegFormId:followUpIdId conversationRegFormId:followUpCodeId" render="conversationRegFormId:conversationWizardPanelId" />
											</h:commandButton>
										</h:panelGroup>
									</td>
								</tr>
							</table>
						</h:panelGroup>
					</td>
				</tr>
				<tr>
					<td width="100%">
						<h:panelGroup id="conversationWizardPanelId">
							<h:panelGroup rendered="#{ not empty conversationRegisteration.conversationData.followUpId}">
								<p:wizard id="wizardId" styleClass="prime_float" widgetVar="wizard" nextLabel="#{msgs.label_proceedToNext}" backLabel="#{msgs.label_back}" flowListener="#{conversationRegisteration.onFlowProcess}">
									<p:tab id="convMainDataTabId" title="#{msgs.label_conversationMainData}">
										<table border="0" cellpadding="0" cellspacing="0" width="100%">
											<tr>
												<td>
													<table class="sectionTitle" border="0" cellpadding="0" cellspacing="0">
														<tr>
															<td>
																<h:outputText value="&#xf044;" styleClass="fontawesome" />
																<h:outputText value="#{msgs.title_conversationMainData}" />
															</td>
														</tr>
													</table>
												</td>
											</tr>
											<tr>
												<td width="100%">
													<h:panelGroup id="conversationMaidDataPanelId">
														<table class="sectionContent" border="0" cellpadding="0" cellspacing="0">
															<tr>
																<th width="15%">
																	<h:outputText value="#{msgs.label_conversationType}" />
																	<h:outputText rendered="#{conversationRegisteration.pageMode == 2}" value="*" style="color:red;" />
																</th>
																<td width="35%">
																	<h:selectOneRadio disabled="#{conversationRegisteration.pageMode != 2}" id="selectedConvTypeRadioId" value="#{conversationRegisteration.conversationData.conversationType}">
																		<f:selectItem itemLabel="#{msgs.title_direct}" itemValue="#{conversationRegisteration.conversationDirectType}" />
																		<f:selectItem itemLabel="#{msgs.title_inject}" itemValue="#{conversationRegisteration.conversationInjectType}" />
																	</h:selectOneRadio>
																</td>
																<th width="15%" rowspan="2">
																	<h:outputText value="#{msgs.label_conversationCoordinates}" />
																</th>
																<td width="20%" rowspan="2">
																	<code:coordinates disabled="#{conversationRegisteration.pageMode != 2}" latitude="#{conversationRegisteration.conversationData.coordinateLatitude}" longitude="#{conversationRegisteration.conversationData.coordinateLongitude}" emptyLatitude="#{conversationRegisteration.conversationData.coordinateLatitude == null or conversationRegisteration.conversationData.coordinateLatitude == 0.0 ? true : false}" emptyLongitude="#{conversationRegisteration.conversationData.coordinateLongitude == null or conversationRegisteration.conversationData.coordinateLongitude == 0.0 ? true : false}" />
																</td>
															</tr>
															<tr>
																<th width="15%">
																	<h:outputText value="#{msgs.label_conversationDate}" />
																	<h:outputText rendered="#{conversationRegisteration.pageMode == 2}" value="*" style="color:red;" />
																</th>
																<td width="35%">
																	<util:advancedHijriDate disable="#{conversationRegisteration.pageMode != 2}" value="#{conversationRegisteration.conversationData.conversationDate}" />
																</td>
															</tr>
															<tr>
																<th width="15%">
																	<h:outputText value="#{msgs.label_conversationTime}" />
																	<h:outputText rendered="#{conversationRegisteration.pageMode == 2}" value="*" style="color:red;" />
																</th>
																<td>
																	<p:inputMask disabled="#{conversationRegisteration.pageMode != 2}" id="conversationTimeId" style=" direction: ltr; text-align: right; " value="#{conversationRegisteration.conversationData.conversationTime}" mask="99:99" onblur="return validateTime();" />
																</td>
																<th width="15%" rowspan="3">
																	<h:outputText value="#{msgs.label_conversationLocation}" />
																	<h:outputText rendered="#{conversationRegisteration.pageMode == 2}" value="*" style="color:red;" />
																</th>
																<td width="35%" rowspan="3">
																	<h:inputTextarea disabled="#{conversationRegisteration.pageMode != 2}" styleClass="form-control" style="width: 100%;" value="#{conversationRegisteration.conversationData.conversationLocation}" onkeypress="return valdiateMaxLength(this, 500);" onblur="return isValdiateMaxLength(this, 500);" />
																</td>
															</tr>

														</table>
													</h:panelGroup>
												</td>
											</tr>
										</table>
									</p:tab>
									<p:tab id="convDetailsDataTabId" title="#{msgs.label_conversationDetailsData}">
										<table border="0" cellpadding="0" cellspacing="0" width="100%">
											<tr>
												<td>
													<table class="sectionTitle" border="0" cellpadding="0" cellspacing="0">
														<tr>
															<td>
																<h:outputText value="&#xf044;" styleClass="fontawesome" />
																<h:outputText value="#{msgs.title_conversationDetails}" />
															</td>
														</tr>
													</table>
												</td>
											</tr>
											<tr>
												<td>
													<table class="sectionContent" border="0" cellpadding="0" cellspacing="0">
														<tr>
															<td>
																<h:panelGroup id="insertConversationPartyPanelId">
																	<table width="100%">
																		<tr>
																			<td>
																				<h:panelGroup rendered="#{conversationRegisteration.pageMode == 2}">
																					<h:commandButton styleClass="btn btn-warning" value="#{msgs.label_insertConversationParty}" onclick="return getConversationParty('#{request.contextPath}');" />

																					<h:inputHidden id="selectedConvPartyContactNumberId" value="#{conversationRegisteration.conversationPartyData.contactNumber}" />
																					<h:inputHidden id="selectedConvPartyNameId" value="#{conversationRegisteration.conversationPartyData.name}" />
																					<h:inputHidden id="selectedConvPartyFollowUpCodeId" value="#{conversationRegisteration.conversationPartyData.followUpCode}" />
																					<h:inputHidden id="selectedConvPartyNetworkRoleId" value="#{conversationRegisteration.conversationPartyData.domainIdNetworkRoles}" />
																					<h:inputHidden id="selectedConvPartyNetworkRoleDescId" value="#{conversationRegisteration.conversationPartyData.domainIdNetworkRolesDesc}" />
																					<h:commandButton style="display:none;" id="conversationPartyHiddenBtnId" action="#{conversationRegisteration.insertConversationParty()}">
																						<f:ajax render="conversationRegFormId:conversationPartyDataTableId" execute="conversationRegFormId:insertConversationPartyPanelId" />
																					</h:commandButton>
																				</h:panelGroup>
																			</td>
																		</tr>
																	</table>
																</h:panelGroup>
															</td>
														</tr>

														<tr>
															<td>
																<p:dataTable reflow="true" tableStyle="table-layout: auto" paginator="true" id="conversationPartyDataTableId" rows="#{conversationRegisteration.rowsCount}" rowIndexVar="index" var="row" value="#{conversationRegisteration.conversationPartyDataList}" rowHover="true">
																	<p:column styleClass='centerText'>
																		<f:facet name="header">#</f:facet>
					                                                    #{index + 1}
					                                                 </p:column>
																	<p:column styleClass='centerText'>
																		<f:facet name="header">
																			<h:outputText value="#{msgs.label_conversationPartyContactNumber}" />
																		</f:facet>
																		<h:outputText value="#{row.contactNumber}" />
																	</p:column>
																	<p:column styleClass='centerText'>
																		<f:facet name="header">
																			<h:outputText value="#{msgs.label_conversationPartyName}" />
																		</f:facet>
																		<h:outputText value="#{row.name}" />
																	</p:column>
																	<p:column styleClass='centerText'>
																		<f:facet name="header">
																			<h:outputText value="#{msgs.label_theCode}" />
																		</f:facet>
																		<h:outputText value="#{row.followUpCode}" />
																	</p:column>
																	<p:column styleClass='centerText'>
																		<f:facet name="header">
																			<h:outputText value="#{msgs.label_NetworkRole}" />
																		</f:facet>
																		<h:outputText value="#{row.domainIdNetworkRolesDesc}" />
																	</p:column>
																	<p:column rendered="#{conversationRegisteration.pageMode == 2}" styleClass='centerText'>
																		<f:facet name="header">#{msgs.label_delete}</f:facet>
																		<h:commandButton value="&#xf00d;" styleClass="btn btn-trans-icon" action="#{conversationRegisteration.deleteConversationParty(row)}" onclick="return confirm('#{msgs.q_delete}');">
																			<f:ajax render="conversationRegFormId:conversationPartyDataTableId" execute="conversationRegFormId:conversationPartyDataTableId" />
																		</h:commandButton>
																	</p:column>
																</p:dataTable>
															</td>
														</tr>

														<tr>
															<td>
																<h:panelGroup id="conversationSummaryyDetailPanelId">
																	<table class="sectionContent" border="0" cellpadding="0" cellspacing="0">
																		<tr>
																			<th width="15%">
																				<h:outputText value="#{msgs.label_conversationResult}" />
																				<h:outputText rendered="#{conversationRegisteration.pageMode == 2}" value="*" style="color:red;" />
																			</th>
																			<td width="35%">
																				<h:selectOneRadio disabled="#{conversationRegisteration.pageMode != 2}" id="conversationResultId" value="#{conversationRegisteration.conversationData.conversationResult}" layout="grid" columns="1">
																					<f:selectItem itemLabel="#{msgs.label_conversationNegative}" itemValue="#{conversationRegisteration.conversationNegativeValue}" />
																					<f:selectItem itemLabel="#{msgs.label_conversationPositive}" itemValue="#{conversationRegisteration.conversationPositiveValue}" />
																					<f:ajax event="change" render="conversationRegFormId:conversationSummaryyDetailPanelId" execute="conversationRegFormId:conversationSummaryyDetailPanelId" listener="#{conversationRegisteration.changeConversationResult()}" />
																				</h:selectOneRadio>
																			</td>
																		</tr>
																		<tr>
																			<th width="15%">
																				<h:outputText value="#{msgs.label_conversationDetailsData}" />
																				<h:outputText rendered="#{conversationRegisteration.pageMode == 2}" value="*" style="color:red;" />
																			</th>
																			<td colspan="3">
																				<h:inputTextarea disabled="#{conversationRegisteration.pageMode != 2}" id="conversationDetailsId" styleClass="form-control" style="width: 100%;" value="#{conversationRegisteration.conversationData.conversationDetails}" onkeypress="return valdiateMaxLength(this, 2000);" onblur="return isValdiateMaxLength(this, 2000);" />
																			</td>
																		</tr>
																	</table>
																</h:panelGroup>
															</td>
														</tr>
													</table>
												</td>
											</tr>
										</table>
									</p:tab>
									<p:tab id="convProcessDataTabId" title="#{msgs.label_conversationProcesssData}">
										<table border="0" cellpadding="0" cellspacing="0" width="100%">
											<tr>
												<td>
													<table class="sectionTitle" border="0" cellpadding="0" cellspacing="0">
														<tr>
															<td>
																<h:outputText value="&#xf044;" styleClass="fontawesome" />
																<h:outputText value="#{msgs.title_conversationProcesssDetails}" />
															</td>
														</tr>
													</table>
												</td>
											</tr>
											<tr>
												<td width="100%">
													<table class="sectionContent" border="0" cellpadding="0" cellspacing="0">
														<tr>
															<th width="15%">
																<h:outputText value="#{msgs.label_conversationProcessType}" />
															</th>
															<td colspan="1">
																<h:selectOneMenu disabled="#{conversationRegisteration.pageMode != 2}" id="actionTakenId" style="width:60%;" value="#{conversationRegisteration.conversationData.domainIdChatAction}">
																	<f:ajax execute="@this" render="conversationRegFormId:regionIdPanelGroup"></f:ajax>
																	<f:selectItem itemLabel="#{msgs.label_all}" itemValue="#{null}" />
																	<f:selectItems value="#{conversationRegisteration.actionTypeList}" var="action" itemLabel="#{action.description}" itemValue="#{action.id}" />
																</h:selectOneMenu>
															</td>
															<td></td>
															<td></td>
														</tr>
														<tr>
															<th width="15%">
																<h:outputText value="#{msgs.label_taskAction}" />
															</th>
															<td colspan="3">
																<h:inputTextarea disabled="#{conversationRegisteration.pageMode != 2}" styleClass="form-control" style="width: 100%;" value="#{conversationRegisteration.conversationData.actionTaken}" onkeypress="return valdiateMaxLength(this, 500);" onblur="return isValdiateMaxLength(this, 500);" />
															</td>
														</tr>
														<tr>
															<td colspan = "2">
																<h:panelGroup id="regionIdPanelGroup">
																	<table class="sectionContent" border="0" cellpadding="0" cellspacing="0">
																		<tr>
																			<h:panelGroup rendered="#{conversationRegisteration.conversationData.domainIdChatAction != null}">
																				<th width="15%">
																					#{msgs.label_region}
																					<h:outputText value="*" style="color:red;" />
																				</th>
																				<td colspan="1">
																					<h:selectOneMenu styleClass="form-control" value="#{conversationRegisteration.conversationData.regionId}">
																						<f:selectItem itemValue="" itemLabel=" " />
																						<f:selectItems value="#{conversationRegisteration.regionsList}" var="region" itemLabel="#{region.regionName}" itemValue="#{region.id}" />
																					</h:selectOneMenu>
																				</td>
																			</h:panelGroup>
																		</tr>
																	</table>
																</h:panelGroup>
															</td>
														</tr>
													</table>
												</td>
											</tr>

											<tr>
												<td>
													<p:fieldset toggleable="true" id="referralPanelId" legend="&#xf08e; #{msgs.label_referralDetails}" collapsed="true" styleClass="fontawesome">
														<table width="100%">
															<tr>
																<td>
																	<table class="sectionContent" border="0" cellpadding="0" cellspacing="0">
																		<tr>
																			<td>
																				<h:panelGroup id="insertReferralPanelId">
																					<table width="100%">
																						<tr>
																							<td>
																								<h:panelGroup rendered="#{conversationRegisteration.pageMode == 2}">
																									<h:commandButton styleClass="btn btn-warning" value="#{msgs.label_insertRefeeral}" onclick="return getReferralSearch('#{request.contextPath}');" />

																									<h:inputHidden id="domainIdReferralTypeDesId" value="#{conversationRegisteration.referralData.domainIdReferralTypeDesc}" />
																									<h:inputHidden id="domainIdReferralTypeId" value="#{conversationRegisteration.referralData.domainIdReferralType}" />
																									<h:inputHidden id="employeeNumberId" value="#{conversationRegisteration.referralData.employeeNumber}" />
																									<h:inputHidden id="employeeNameId" value="#{conversationRegisteration.referralData.employeeName}" />
																									<h:inputHidden id="referralDataDetailsId" value="#{conversationRegisteration.referralData.details}" />
																									<h:commandButton style="display:none;" id="referralDataHiddenBtnId" action="#{conversationRegisteration.insertReferral()}">
																										<f:ajax render="conversationRegFormId:referralDataTableId" execute="conversationRegFormId:insertReferralPanelId" />
																									</h:commandButton>
																								</h:panelGroup>
																							</td>
																						</tr>
																					</table>
																				</h:panelGroup>
																			</td>
																		</tr>

																		<tr>
																			<td>
																				<p:dataTable reflow="true" tableStyle="table-layout: auto" paginator="true" id="referralDataTableId" rows="#{conversationRegisteration.rowsCount}" rowIndexVar="index" var="row" value="#{conversationRegisteration.referralDataList}" rowHover="true">
																					<p:column styleClass='centerText'>
																						<f:facet name="header">#</f:facet>
					                                                                 #{index + 1}
					                                                                </p:column>
																					<p:column styleClass='centerText'>
																						<f:facet name="header">
																							<h:outputText value="#{msgs.label_referralType}" />
																						</f:facet>
																						<h:outputText value="#{row.domainIdReferralTypeDesc}" />
																					</p:column>
																					<p:column styleClass='centerText'>
																						<f:facet name="header">
																							<h:outputText value="#{msgs.label_referralSpecialistEmp}" />
																						</f:facet>
																						<h:outputText value="#{row.employeeName}" />
																					</p:column>
																					<p:column styleClass='centerText'>
																						<f:facet name="header">
																							<h:outputText value="#{msgs.label_description}" />
																						</f:facet>
																						<h:outputText value="#{row.details}" />
																					</p:column>
																					<p:column rendered="#{conversationRegisteration.pageMode == 2}" styleClass='centerText'>
																						<f:facet name="header">#{msgs.label_delete}</f:facet>
																						<h:commandButton rendered="#{empty row.id}" value="&#xf00d;" styleClass="btn btn-trans-icon" action="#{conversationRegisteration.deleteReferralData(row)}" onclick="return confirm('#{msgs.q_delete}');">
																							<f:ajax render="conversationRegFormId:referralDataTableId" execute="conversationRegFormId:referralDataTableId" />
																						</h:commandButton>
																					</p:column>
																				</p:dataTable>
																			</td>
																		</tr>
																	</table>
																</td>
															</tr>
														</table>

													</p:fieldset>
												</td>
											</tr>

											<tr>
												<td width="100%" height="5" />
											</tr>

											<tr>
												<td>
													<h:panelGroup rendered="#{empty conversationRegisteration.conversationData.id}">
														<table class="sectionContent" border="0" cellpadding="0" cellspacing="0">
															<tr>
																<th width="15%">#{msgs.label_attachmendUploadQuestion}</th>
																<td width="70%">
																	<h:selectOneRadio id="uploadFlagId" value="#{conversationRegisteration.uploadFlag}">
																		<f:selectItem itemValue="#{msgs.label_yes}" itemLabel="#{msgs.label_yes}" />
																		<f:selectItem itemValue="#{msgs.label_no}" itemLabel="#{msgs.label_no}" />
																	</h:selectOneRadio>
																</td>
															</tr>
														</table>
													</h:panelGroup>
												</td>
											</tr>

											<tr>
												<td width="100%" height="5" />
											</tr>

											<tr>
												<td>
													<h:panelGroup id="insertReminderPanelId">
														<table class="actionsSection" border="0" cellpadding="0" cellspacing="0" width="100%">
															<tr>
																<td>
																	<h:commandButton rendered="#{conversationRegisteration.pageMode == 2}" value="&#xf1d8; #{msgs.label_saveAndSend}" styleClass="btn btn-success" action="#{conversationRegisteration.saveConversationData()}" onclick="return confirm('#{msgs.q_confirm}');">
																		<f:ajax render="conversationRegFormId:notifyMessagesId conversationRegFormId:conversationWizardPanelId" execute="conversationRegFormId:followUpContainerId conversationRegFormId:conversationWizardPanelId" onevent="expandClassificationTypeFieldSet" />
																	</h:commandButton>

																	<h:commandButton rendered="#{conversationRegisteration.pageMode == 2}" styleClass="btn btn-warning" value="#{msgs.title_insertReminder}" onclick="return getReminder('#{request.contextPath}');" />

																	<h:inputHidden id="reminderDateId" value="#{conversationRegisteration.reminderData.reminderDateString}" />
																	<h:inputHidden id="reminderTimeId" value="#{conversationRegisteration.reminderData.reminderTime}" />
																	<h:inputHidden id="reminderDetailsId" value="#{conversationRegisteration.reminderData.reminderDetails}" />

																	<h:commandButton style="display:none;" id="reminderHiddenBtnId" action="#{conversationRegisteration.insertReminder()}">
																		<f:ajax execute="conversationRegFormId:insertReminderPanelId" />
																	</h:commandButton>

																	<h:commandButton rendered="#{not empty conversationRegisteration.conversationData.id and conversationRegisteration.pageMode == 2}" styleClass="btn btn-success" id="archiveBtnUploadId" value="&#xf187; #{msgs.label_archiveDocuments}">
																		<f:ajax listener="#{conversationRegisteration.getUploadParam(conversationRegisteration.conversationData.id)}" render="conversationRegFormId:fileArchivingParamId" onevent="function(e){if(e.status == 'success') return uploadFile();}" />
																	</h:commandButton>

																	<h:commandButton rendered="#{not empty conversationRegisteration.conversationData.id}" styleClass="btn btn-success" id="archiveBtnDownloadId" value="&#xf0c5; #{msgs.label_archiveDocumentsShow}">
																		<f:ajax render="conversationRegFormId:downloadDlgPanelId conversationRegFormId:openDownloadDialogueFlagId conversationRegFormId:openDownloadPopupFlagId conversationRegFormId:downloadedFileParamId" listener="#{conversationRegisteration.getDownloadedAttachmentsIdList(conversationRegisteration.conversationData.id)}" onevent="handleDownloadFiles" />
																	</h:commandButton>

																	<h:inputHidden id="fileArchivingParamId" value="#{conversationRegisteration.fileArchivingParam}" />
																	<h:inputHidden id="downloadedFileParamId" value="#{conversationRegisteration.downloadFileParamId}" />
																	<h:inputHidden id="openDownloadPopupFlagId" value="#{conversationRegisteration.openDownloadPopupFlag}" />
																	<h:inputHidden id="openDownloadDialogueFlagId" value="#{conversationRegisteration.openDownloadDialogueFlag}" />
																</td>
															</tr>
														</table>
													</h:panelGroup>
												</td>
											</tr>
										</table>
									</p:tab>
								</p:wizard>
							</h:panelGroup>
						</h:panelGroup>
					</td>
				</tr>
			</table>
			<h:panelGroup id="downloadDlgPanelId">
				<p:dialog dir="#{msgs.dir}" header="#{msgs.label_archiveDocumentsShow}" id="dlgId" widgetVar="dlg" modal="true" height="180px;" width="720px">
					<h:panelGroup id="internalDlgPanelId" rendered="#{conversationRegisteration.attachmentList.size() > 1}">
						<table width="100%">
							<tr>
								<td>
									<p:dataTable tableStyle="table-layout:auto" reflow="true" liveResize="true" paginatorPosition="bottom" id="fileListIds" paginator="true" style="width:100%" rowIndexVar="index" rows="10" var="row" value="#{conversationRegisteration.attachmentList}" widgetVar="table" rowHover="true">
										<p:column styleClass='centerText'>
											<f:facet name="header">#</f:facet>
		                                    #{index + 1}
	                                   	</p:column>
										<p:column styleClass='centerText'>
											<f:facet name="header">
													#{msgs.label_fileName}
												</f:facet>
											<h:outputText value="#{row.fileName}" />
										</p:column>
										<p:column styleClass='centerText'>
											<f:facet name="header">
												#{msgs.label_download}
											</f:facet>
											<h:commandButton styleClass="btn btn-success" value="&#xf019; #{msgs.label_download}">
												<f:ajax render="conversationRegFormId:internalDlgPanelId conversationRegFormId:downloadedFileParamId" listener="#{conversationRegisteration.getDownloadParam(row.attachmentId)}" onevent="function(e){if(e.status == 'success') return downloadFile();}" />
											</h:commandButton>
										</p:column>
									</p:dataTable>
								</td>
							</tr>
						</table>
					</h:panelGroup>
				</p:dialog>
			</h:panelGroup>
		</ui:decorate>
	</h:form>
</h:body>
</html>