<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xmlns:h="http://java.sun.com/jsf/html" xmlns:p="http://primefaces.org/ui" xmlns:ui="http://java.sun.com/jsf/facelets" xmlns:f="http://java.sun.com/jsf/core" xmlns:util="http://java.sun.com/jsf/composite/util" xmlns:code="http://java.sun.com/jsf/composite/code">
<h:head>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	<h:outputStylesheet library="css" name="styles.css" />
	<h:outputStylesheet library="css" name="grid.css" />
	<h:outputStylesheet library="css" name="bootstrap.css" />
	<h:outputScript name="utilities.js" library="javascript" target="head" />
	<script type="text/javascript">
		var m;
		function calculateFollowUpEndDate() {
			var extendPeriod = document.getElementById('mainFormId:extensionDurationId').value;
			if (extendPeriod == null || extendPeriod == "") {
				showErrorMessage('#{msgs.label_mandatory}');
				return false;
			} else {
				document.getElementById('mainFormId:calculateFollowUpEndDateBtnId').click();
			}
		}
		function getEmployee(contextPath) {
			m = 1;
			openEmpsMiniSearch(contextPath, 1, null, null);
			return false;
		}

		function getExternalSide(contextPath) {
			m = 2;
			openExternalSidesMiniSearch(contextPath);
			return false;
		}
		function HandlePopupResult(ret) {
			unMaskScreen();
			if (ret != null) {
				if (m == 1) {
					document.getElementById('mainFormId:searchEmployeeIdId').value = ret[0];
					document.getElementById('mainFormId:searchEmployeeHiddenNameId').value = ret[1];
					document.getElementById('mainFormId:searchEmployeeNameInputTextId').value = ret[1];
					return true;
				} else if (m == 2) {
					document.getElementById('mainFormId:externalSideId').value = ret[0];
					document.getElementById('mainFormId:externalSideDescId').value = ret[1];
					document.getElementById('mainFormId:externalSideDescHiddenId').value = ret[1];
					document.getElementById('mainFormId:externalSideDescId').innerHTML = ret[1];
					document.getElementById('mainFormId:renderspecialistEmployeeBtnId').click();
					return true;
				}
				return false;
			}
		}

		function releaseMask() {
			unMaskScreen();
		}
	</script>
</h:head>
<h:body styleClass="screenBg">
	<h:form id="mainFormId" dir="#{msgs.dir}">
		<ui:decorate template="/Main/Template.xhtml">
			<table border="0" cellpadding="0" cellspacing="0" width="100%">

				<tr>
					<td class="screenTitle">#{msgs.title_followUpTakeAction}</td>
				</tr>

				<tr>
					<td width="100%" height="5" />
				</tr>

				<tr>
					<td>
						<h:panelGroup id="followUpContainerId">
							<table class="sectionContent" border="0" cellpadding="0" cellspacing="0" style="width: 50%;">
								<tr>
									<th>
										<h:outputText value="#{msgs.label_followUp}" />
										<h:outputText value="*" style="color:red;" />
									</th>
									<td>
										<h:panelGroup id="codePanelId">
											<h:inputText disabled="true" id="followUpCodeViewId" value="#{followUpTakeAction.followUpData.code}" style="width:88%;" />
										</h:panelGroup>
									</td>
								</tr>
							</table>
						</h:panelGroup>
					</td>
				</tr>

				<tr>
					<td width="100%" height="5" />
				</tr>
				<tr>
					<td>
						<p:accordionPanel id="followUpInformationPanelId" activeIndex="-1">
							<p:tab title="#{msgs.label_currentFollowUpData}">

								<table class="sectionContent" border="0" cellpadding="0" cellspacing="0">
									<tr>
										<td>
											<h:panelGroup id="currentFollowUpId">
												<table width="100%">
													<tr>
														<th width="15%">#{msgs.label_followUpCode}</th>
														<td width="20%">
															<h:inputText id="followUpCodeId_" styleClass="form-control" value="#{followUpTakeAction.followUpData.code}" disabled="true" />
														</td>

														<th width="15%;">#{msgs.label_followUpDataSource}</th>
														<td width="20%">
															<h:inputText id="sourceDataId" styleClass="form-control" value="#{followUpTakeAction.followUpData.dataSourceDesc}" disabled="true" />
														</td>

													</tr>
													<tr>
														<th width="15%">#{msgs.label_followUpStartDate}</th>
														<td width="20%">
															<util:advancedHijriDate id="followUpStartDateId" disable="true" value="#{followUpTakeAction.followUpData.followUpStartDate}" />

														</td>

														<th width="15%;">#{msgs.label_followUpCoordinates}</th>
														<td width="20%">
															<h:inputText disabled="true" id="latId" styleClass="form-control" value="#{followUpTakeAction.followUpData.coordinateLatitude}" disable="true" />
														</td>

													</tr>
													<tr>
														<th width="15%">#{msgs.label_followUpEndDate}</th>
														<td width="20%">
															<util:advancedHijriDate id="followUpEndDateId" disable="true" value="#{followUpTakeAction.followUpData.followUpEndDate}" />

														</td>

														<th width="15%;"></th>
														<td width="20%">
															<h:inputText id="longId" disabled="true" styleClass="form-control" value="#{followUpTakeAction.followUpData.coordinateLongitude}" disable="true" />
														</td>

													</tr>
													<tr>
														<th width="15%">#{msgs.label_caseType}</th>
														<td width="20%">
															<h:inputText id="caseTypeId" disabled="true" styleClass="form-control" value="#{followUpTakeAction.followUpData.casesTypeDesc}" disable="true" />

														</td>

														<th width="15%">#{msgs.label_direct}</th>
														<td width="20%">
															<h:selectOneMenu id="directFlagId" value="#{followUpTakeAction.followUpData.directFlag}" styleClass="form-control" disabled="true">
																<f:selectItem itemLabel="#{msgs.label_all}" itemValue="-1" />
																<f:selectItem itemLabel="#{msgs.label_yes}" itemValue="1" />
																<f:selectItem itemLabel="#{msgs.label_no}" itemValue="0" />
															</h:selectOneMenu>
														</td>

													</tr>
													<tr>
														<th width="15%">#{msgs.label_ghostType}</th>
														<td width="20%">
															<h:inputText id="ghostTypeId" styleClass="form-control" value="#{followUpTakeAction.followUpData.ghostType == 1 ? msgs.label_employeeTitle : msgs.label_nonEmpTitle}" disabled="true" />
														</td>

														<th width="15%;">#{msgs.label_equipmentTypeId}"</th>
														<td width="20%">
															<h:inputText id="equipmentId" styleClass="form-control" value="#{followUpTakeAction.followUpData.equipmentTypeDesc}" disabled="true" />
														</td>

													</tr>
													<tr>
														<th width="15%">#{msgs.label_identity}</th>
														<td width="20%">
															<h:inputText id="employeeSocialIdId" styleClass="form-control" rendered="#{followUpTakeAction.followUpData.ghostType == 1}" value="#{followUpTakeAction.followUpData.employeeSocialId}" disabled="true" />
															<h:inputText id="nonEmployeeSocialIdId" styleClass="form-control" rendered="#{followUpTakeAction.followUpData.ghostType == 1}" value="#{followUpTakeAction.followUpData.nonEmployeeSocialId}" disabled="true" />

														</td>

														<th width="15%;"></th>
														<td width="20%"></td>

													</tr>

													<tr>
														<th width="15%">#{msgs.label_ghostAliasName_}</th>
														<td width="20%">
															<h:inputText id="aliasNameId" styleClass="form-control" value="#{ followUpTakeAction.followUpData.aliasName }" disabled="true" />
														</td>

														<th width="15%;">#{msgs.label_name}</th>
														<td width="20%">
															<h:inputText id="employeeNameId" styleClass="form-control" rendered="#{followUpTakeAction.followUpData.ghostType == 1}" value="#{followUpTakeAction.followUpData.employeeName}" disabled="true" />
															<h:inputText id="nonEmployeeNameId" styleClass="form-control" rendered="#{followUpTakeAction.followUpData.ghostType == 1}" value="#{followUpTakeAction.followUpData.nonEmployeeName}" disabled="true" />
														</td>

													</tr>
													<tr>
														<th width="15%">#{msgs.label_region}</th>
														<td width="20%">
															<h:inputText id="sectorId" styleClass="form-control" value="#{ followUpTakeAction.followUpData.regionName}" disabled="true" />
														</td>

														<th width="15%;">#{msgs.label_sector}</th>
														<td width="20%">
															<h:inputText id="regionId" styleClass="form-control" value="#{followUpTakeAction.followUpData.sectorName}" disabled="true" />
														</td>
													</tr>
												</table>
											</h:panelGroup>
										</td>
									</tr>
								</table>
							</p:tab>
						</p:accordionPanel>
					</td>
				</tr>

				<tr>
					<td width="100%" height="5" />
				</tr>

				<tr>
					<td colspan="2">
						<table class="sectionTitle" border="0" cellpadding="0" cellspacing="0">
							<tr>
								<td>
									<h:outputText value="#{msgs.title_actionTaken}" />
								</td>
							</tr>
						</table>
					</td>
				</tr>

				<tr>
					<td width="100%" height="5" />
				</tr>

				<tr>
					<td>
						<h:panelGroup id="selectDecisionTypePanelId">
							<table class="sectionContent" border="0" cellpadding="0" cellspacing="0">
								<tr>
									<th width="15%">
										#{msgs.label_decisionType}
										<h:outputText value="*" style="color:red;" />
									</th>
									<td width="35%">
										<h:selectOneMenu id="decisionTypeId" style="width:35%;" value="#{followUpTakeAction.decisionData.decisionType}">
											<f:selectItem itemLabel="#{msgs.label_followUpExtend}" itemValue="#{followUpTakeAction.followUpExtended}" />
											<f:selectItem itemLabel="#{msgs.label_followUpEnded}" itemValue="#{followUpTakeAction.followUpEnd}" />
											<f:ajax event="change" render="mainFormId:selectDecisionTypePanelId mainFormId:empPanelId" execute="mainFormId:decisionTypeId" listener="#{followUpTakeAction.clearData()}" />
										</h:selectOneMenu>
									</td>
									<h:panelGroup rendered="#{followUpTakeAction.decisionData.decisionType == followUpTakeAction.followUpExtended}">
										<th width="15%">
											#{msgs.label_extendPeriod}
											<h:outputText value="*" style="color:red;" />
										</th>
										<td width="35%">
											<h:inputText id="extensionDurationId" style="width: 85%;margin-left: 5px;" value="#{followUpTakeAction.decisionData.extensionDuration}" onblur="return calculateFollowUpEndDate();" onkeypress="return checkDigit(event);" />
											#{msgs.label_day}
											<h:commandButton id="calculateFollowUpEndDateBtnId" style="display : none ;" action="#{followUpTakeAction.calculateFollowUpEndDate()}">
												<f:ajax execute="mainFormId:extensionDurationId" render="mainFormId:selectDecisionTypePanelId" />
											</h:commandButton>
										</td>
									</h:panelGroup>
									<h:panelGroup rendered="#{followUpTakeAction.decisionData.decisionType == followUpTakeAction.followUpEnd}">
										<th width="15%">#{msgs.label_resumeDate}</th>
										<td width="35%">
											<util:advancedHijriDate id="resumeDateId" value="#{followUpTakeAction.decisionData.resumeDate}" listener="#{followUpTakeAction.dateChangedListener}" renderIds="mainFormId:followUpEndDateViewId" />
										</td>
									</h:panelGroup>
								</tr>
								<tr>
									<th>
										<h:outputText value="#{msgs.label_sendToExternalSides}" />
									</th>
									<td>
										<h:inputText disabled="true" id="externalSideDescId" value="#{followUpTakeAction.decisionData.domainIdExternalSidesDesc}" style="width:75%;" />
										<h:commandButton value="&#xf03a;" styleClass="btn btn-trans-icon" onclick="return getExternalSide('#{request.contextPath}');" />
										<h:inputHidden id="externalSideId" value="#{followUpTakeAction.decisionData.domainIdExternalSides}" />
										<h:inputHidden id="externalSideDescHiddenId" value="#{followUpTakeAction.decisionData.domainIdExternalSidesDesc}" />
										<h:commandButton id="renderspecialistEmployeeBtnId" style="display : none ;" action="#{followUpTakeAction.refreshSubmit()}">
											<f:ajax execute="mainFormId:externalSideId mainFormId:externalSideDescHiddenId" render="mainFormId:selectDecisionTypePanelId" />
										</h:commandButton>
									</td>
									<th width="15%">#{msgs.label_followUpEndDate}</th>
									<td width="35%">
										<h:inputText disabled="true" styleClass="form-control" id="followUpEndDateViewId" value="#{followUpTakeAction.followUpEndDateStr}" />
									</td>
								</tr>
								<tr>
									<h:panelGroup id="empPanelId">
										<th width="15%">
											<h:outputText value="#{msgs.label_referralSpecialistEmp}" />
											<h:outputText rendered="#{not empty followUpTakeAction.decisionData.domainIdExternalSides}" value="*" style="color:red;" />
										</th>
										<td width="35%">
											<h:inputText disabled="true" id="searchEmployeeNameInputTextId" value="#{followUpTakeAction.decisionData.employeeName}" style="width:75%;" />

											<h:commandButton rendered="#{not empty followUpTakeAction.decisionData.domainIdExternalSides}" value="&#xf03a;" styleClass="btn btn-trans-icon" onclick="return getEmployee('#{request.contextPath}');" />
											<h:inputHidden id="searchEmployeeIdId" value="#{followUpTakeAction.decisionData.empId}" />
											<h:inputHidden id="searchEmployeeHiddenNameId" value="#{followUpTakeAction.decisionData.employeeName}" />
										</td>
									</h:panelGroup>
									<th width="15%" rowspan="2">#{msgs.label_comment}</th>
									<td width="20%" rowspan="2">
										<h:inputTextarea styleClass="form-control" style="width: 100%;" value="#{followUpTakeAction.decisionData.notes}" rows="5" />
									</td>
								</tr>
								<tr>
									<h:panelGroup rendered="#{followUpTakeAction.decisionData.decisionType == followUpTakeAction.followUpEnd}">
										<th>
											#{msgs.label_stopReason}
											<h:outputText value="*" style="color:red;" />
										</th>
										<td>
											<h:selectOneMenu id="stopReasonId" style="width:60%;" value="#{followUpTakeAction.decisionData.domainIdStopReasons}">
												<f:selectItems value="#{followUpTakeAction.stopReasonList}" var="stop" itemLabel="#{stop.description}" itemValue="#{stop.id}" />
											</h:selectOneMenu>
										</td>
									</h:panelGroup>
								</tr>
							</table>
						</h:panelGroup>
					</td>
				</tr>

				<tr>
					<td width="100%" height="5" />
				</tr>
				<tr>
					<td>
						<table class="actionsSection" border="0" cellpadding="0" cellspacing="0">
							<tr>

								<td width="50%">

									<h:commandButton id="saveBtnId" class="btn btn-success" value="#{msgs.label_save}" action="#{followUpTakeAction.saveDecision()}">
									</h:commandButton>
								</td>

							</tr>
						</table>
					</td>
				</tr>

				<tr>
					<td width="100%" height="5" />
				</tr>
			</table>

		</ui:decorate>
	</h:form>
</h:body>
</html>