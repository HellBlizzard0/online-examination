<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xmlns:of="http://omnifaces.org/functions" xmlns:o="http://omnifaces.org/ui" xmlns:h="http://java.sun.com/jsf/html" xmlns:util="http://java.sun.com/jsf/composite/util" xmlns:p="http://primefaces.org/ui" xmlns:ui="http://java.sun.com/jsf/facelets" xmlns:f="http://java.sun.com/jsf/core" xmlns:code="http://java.sun.com/jsf/composite/code">
<h:head>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	<h:outputStylesheet library="css" name="styles.css" />
	<h:outputStylesheet library="css" name="grid.css" />
	<h:outputStylesheet library="css" name="bootstrap.css" />

	<h:outputScript name="utilities.js" library="javascript" target="head" />

	<script type="text/javascript">
	var mode;
	function getAgent(contextPath,m) {
		mode=m;
		if (m==1) {
			openAssignmentsMiniSearch(contextPath,3);
		}
		else {
			openAssignmentsMiniSearch(contextPath,2);
		}
		return false;
	}

	function getInfo(contextPath,id){
		  mode=2;
		  openInfoMiniSearch(contextPath,5,id,null,null);
		  return false;
	}

	function releaseMask() {
		unMaskScreen();
	}

	function HandlePopupResult(ret) {
		unMaskScreen();
		if (ret != null) { 
			if ( (mode == 1) ||(mode == 3) ) {
				document.getElementById('infoRewardFormId:agentSearchIdId').value=ret[0];
         	    document.getElementById('infoRewardFormId:agentSearchCodeId').value=ret[2];
         	    document.getElementById('infoRewardFormId:agentSearchHiddenId').value=ret[2];
         	    document.getElementById('infoRewardFormId:sectorHiddenNameId').value = ret[3];
         	    document.getElementById('infoRewardFormId:sectorNameId').innerHTML=ret[3];
        	    document.getElementById('infoRewardFormId:sectorIdId').value=ret[4];
        	    document.getElementById('infoRewardFormId:sourceHiddenBtn').click();
			} else if (mode == 2) {
				document.getElementById('infoRewardFormId:selectedInfoId').value = ret[0];
				document.getElementById('infoRewardFormId:insertNewRecord').click(); 
			}
			return true;
		}
		return false;
	}
		
	</script>

</h:head>
<h:body styleClass="screenBg">
	<h:form id="infoRewardFormId" dir="#{msgs.dir}">
		<ui:decorate template="/Main/Template.xhtml">
			<table border="0" cellpadding="0" cellspacing="0" width="100%">
				<tr>
					<td class="screenTitle">
						<h:outputText value="#{msgs.title_infoReward}" />
					</td>
				</tr>

				<tr>
					<td width="100%" height="5" />
				</tr>

				<h:panelGroup rendered="#{not empty departmentAccountSupport.errorMessage}">
					<tr>
						<td colspan="2">
							<table class="sectionTitle" border="0" cellpadding="0" cellspacing="0">
								<tr>
									<td>
										<h:outputText style="text-align:center; color: red; font-weight: 600;" value="#{infoReward.errorMessage}" />
									</td>
								</tr>
							</table>
						</td>
					</tr>
					<tr>
						<td width="100%" height="5" />
					</tr>
				</h:panelGroup>

				<tr>
					<td colspan="2">
						<table class="sectionTitle" border="0" cellpadding="0" cellspacing="0">
							<tr>
								<td>
									<h:outputText value="#{msgs.label_requestDetail}" />
								</td>
							</tr>
						</table>
					</td>
				</tr>

				<tr>
					<td width="100%" height="5" />
				</tr>

				<tr>
					<td>
						<h:panelGroup id="infoRewardContainerId">
							<table class="sectionContent" border="0" cellpadding="0" cellspacing="0">

								<tr>
									<th>
										<h:outputText value="#{msgs.label_financialYear}" />
									</th>
									<td>
										<h:outputText value="#{infoReward.finYearApproval.finYear}" />
									</td>
									
									<th>
										<h:outputText value="#{msgs.label_regionAmount}" />
									</th>
									<td colspan="2">
										<h:outputText id="regionAmountId" value="#{infoReward.regionAmount}">
											<f:converter converterId="com.code.ui.converters.CSNumberConverter" />
										</h:outputText>
									</td>
								</tr>

								<tr>
									<th width="15%">
										<h:outputText value="#{msgs.label_paymentNumber}" />
									</th>
									<td width="20%">
										<h:outputText value="#{infoReward.finInfoReward.paymentSerial}" />
									</td>
									
									<th width="15%">
										<h:outputText value="#{msgs.label_paymentDate}" />
									</th>
									<td width="20%">
										<h:outputText value="#{infoReward.finInfoReward.paymentDateString}" />
									</td>

								</tr>

								<tr>
									<th>
										<h:outputText value="#{msgs.label_source}" />
										<h:outputText value="*" style="color:red;" />
									</th>
									<td>
										<h:selectOneMenu value="#{infoReward.sourceType}" styleClass="selectMenuWithIcon">
											<f:selectItem itemLabel="#{msgs.label_assignment}" itemValue="#{infoReward.assignmentType}" />
											<f:selectItem itemLabel="#{msgs.label_cooperator}" itemValue="#{infoReward.cooperatorType}" />
											<f:ajax event="change" execute="infoRewardFormId:infoRewardContainerId" render="infoRewardFormId:infoRewardContainerId infoRewardFormId:infoRewardDetailsPaneId" listener="#{infoReward.resetSource()}" />
										</h:selectOneMenu>
									</td>
									
									<td>
										<h:panelGroup id="sourcPanelId">
											<h:inputHidden id="agentSearchIdId" value="#{infoReward.finInfoReward.assignmentDetailId}" styleClass="inputWithIcon" />
											<h:inputHidden id="agentSearchHiddenId" value="#{infoReward.sourceName}" styleClass="inputWithIcon" />
											<h:inputText disabled="true" styleClass="inputWithIcon" id="agentSearchCodeId" value="#{infoReward.sourceName}" />
											<h:commandButton value="&#xf002;" styleClass="btn btn-trans-icon" id="searchAgentBtnId" onclick="return getAgent('#{request.contextPath}',#{infoReward.sourceType});" />
											<h:commandButton id="sourceHiddenBtn" style="display:none;" action="#{infoReward.emptyInfoList()}">
												<f:ajax execute="infoRewardFormId:sectorIdId infoRewardFormId:agentSearchIdId infoRewardFormId:agentSearchHiddenId" render="infoRewardFormId:infoRewardDetailsPaneId infoRewardFormId:regionAmountId">
												</f:ajax>
											</h:commandButton>
										</h:panelGroup>
									</td>

								</tr>

								<tr>
									<th width="15%">
										<h:outputText value="#{msgs.label_region}" />
									</th>
									<td width="20%">
										<h:outputText value="#{infoReward.regionDepartment.arabicName}" />
									</td>
									
									<th width="15%">
										<h:outputText value="#{msgs.label_sectorUnit}" />
									</th>
									<td width="20%">
										<h:inputHidden id="sectorHiddenNameId" value="#{infoReward.sectorName}" />
										<h:outputText id="sectorNameId" value="#{infoReward.sectorName}" />
										<h:inputHidden id="sectorIdId" value="#{infoReward.sectorId}" />
									</td>

								</tr>

								<tr>
									<th width="15%">
										<h:outputText value="#{msgs.label_paymentMethodIntellegence}" />
									</th>
									<td width="20%">
										<h:selectBooleanCheckbox value="#{infoReward.paymnetMethod}" disabled="#{(infoReward.headQuarter)}">
											<f:ajax execute="@this" listener="#{infoReward.calculateRegionAmount()}" render="infoRewardFormId:regionAmountId"></f:ajax>
										</h:selectBooleanCheckbox>
									</td>
									
									<th width="15%">
										<h:outputText value="#{msgs.label_paymentAmount}" />
										<h:outputText value="*" style="color:red;" />
									</th>
									<td width="20%">
										<h:inputText value="#{infoReward.finInfoReward.amount}" onkeypress="return checkDigit(event)" />
									</td>

								</tr>

								<tr>
									<th width="15%">
										<h:outputText value="#{msgs.label_paymentReason}" />
										<h:outputText value="*" style="color:red;" />
									</th>
									<td colspan="1">
										<h:inputTextarea value="#{infoReward.finInfoReward.paymentReason}" rows="4" cols="80" />
									</td>

								</tr>



							</table>
						</h:panelGroup>
					</td>
				</tr>

				<tr>
					<td width="100%" height="5" />
				</tr>

				<tr>
					<td>
						<h:panelGroup id="infoRewardDetailsPaneId">
							<table width="100%">
								<tr>
									<td colspan="2">
										<table class="sectionTitle" border="0" cellpadding="0" cellspacing="0">
											<tr>
												<td>
													<h:outputText value="#{msgs.title_rewardedInformation}" />
												</td>
											</tr>
										</table>
									</td>
								</tr>
								<tr>
									<td height="10"></td>
								</tr>
								<tr>
									<td>
										<table width="100%" border="0" cellpadding="0" cellspacing="0">
											<tr>
												<td width="100%">
													<h:inputHidden id="selectedInfoId" value="#{infoReward.selectedInfoId}" />
													<h:commandButton id="insertNewRecord" style="display:none;" action="#{infoReward.addInfo()}">
														<f:ajax execute="infoRewardFormId:infoRewardDetailsPaneId" render="infoRewardFormId:infoRewardDetailsPaneId">
														</f:ajax>
													</h:commandButton>
													<h:commandButton class="btn btn-warning" onclick="return getInfo('#{request.contextPath}',#{infoReward.finInfoReward.assignmentDetailId});" value="#{msgs.label_selectInformation}"  disabled="#{empty infoReward.finInfoReward.assignmentDetailId}" />
												</td>
											</tr>
										</table>
									</td>
								</tr>
								<tr>
									<td height="10"></td>
								</tr>
								<tr>
									<td>
										<table width="100%">
											<tr>
												<td>
													<p:dataTable sortMode="multiple" reflow="true" tableStyle="table-layout: auto" paginator="true" id="infoListDataTableId" rows="10" rowIndexVar="index" var="infoRow" value="#{infoReward.infoDataLsit}" rowHover="true">
														<p:column style="text-align: center;">
															<f:facet name="header"> # </f:facet>
								                                #{index + 1}
								                         </p:column>

														<p:column styleClass='centerText'>
															<f:facet name="header"> #{msgs.label_infoNumber} </f:facet>
															<h:outputText id="infoNumberId" value="#{infoRow.infoNumber}" />
														</p:column>

														<p:column styleClass='centerText'>
															<f:facet name="header"> #{msgs.label_RegisterationDate} </f:facet>
															<h:outputText value="#{infoRow.registerationDateString}" />
														</p:column>

														<p:column styleClass='centerText'>
															<f:facet name="header"> #{msgs.label_infoType} </f:facet>
															<h:outputText value="#{infoRow.typeDescription}" />
														</p:column>

														<p:column styleClass='centerText'>
															<f:facet name="header"> #{msgs.label_subject} </f:facet>
															<h:outputText value="#{infoRow.subjectDescription}" />
														</p:column>

													</p:dataTable>
												</td>
											</tr>
										</table>
									</td>
								</tr>
							</table>
						</h:panelGroup>
					</td>
				</tr>

				<tr>
					<td width="100%" height="5" />
				</tr>

				<tr>
					<td>
						<table class="actionsSection" border="0" cellpadding="0" cellspacing="0">
							<tr>
								<td width="100%">
									<h:commandButton rendered="#{empty infoReward.errorMessage}" class="btn btn-success" value="&#xf0c7; #{msgs.label_save}" action="#{infoReward.save()}" onclick="return confirm('#{msgs.q_confirm}');">
									</h:commandButton>
								</td>
							</tr>
						</table>
					</td>
				</tr>

			</table>
		</ui:decorate>
	</h:form>
</h:body>
</html>