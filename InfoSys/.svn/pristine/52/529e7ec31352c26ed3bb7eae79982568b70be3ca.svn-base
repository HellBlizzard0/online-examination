<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xmlns:h="http://java.sun.com/jsf/html" xmlns:p="http://primefaces.org/ui" xmlns:ui="http://java.sun.com/jsf/facelets" xmlns:f="http://java.sun.com/jsf/core" xmlns:util="http://java.sun.com/jsf/composite/util" xmlns:code="http://java.sun.com/jsf/composite/code">
<h:head>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />

	<h:outputStylesheet library="css" name="styles.css" />
	<h:outputStylesheet library="css" name="grid.css" />
	<h:outputStylesheet library="css" name="bootstrap.css" />

	<h:outputScript name="utilities.js" library="javascript" target="head" />

	<script type="text/javascript">
		function expandClassificationTypeFieldSet(e) {
			if (e.status == 'success') {
				$(document.getElementById('formId:guidanceDataContainerId')).children('.ui-fieldset-content').css({
					'display' : 'block'
				});
			}
		}

		function collapseClassificationTypeFieldSet(e) {
			if (e.status == 'success') {
				$(document.getElementById('formId:guidanceDataContainerId')).children('.ui-fieldset-content').css({
					'display' : 'none'
				});
			}
		}
	</script>
</h:head>

<h:body styleClass="screenBg">
	<h:form id="formId" dir="#{msgs.dir}">
		<ui:decorate template="/Main/Template.xhtml">
			<table border="0" cellpadding="0" cellspacing="0" width="100%">
				<tr>
					<td width="100%" height="0" />
				</tr>

				<tr>
					<td class="screenTitle">#{msgs.title_guidanceRequest}</td>
				</tr>

				<tr>
					<td width="100%" height="5" />
				</tr>

				<tr>
					<td>
						<h:panelGroup id="searchContainerId">
							<table class="sectionContent" border="0" cellpadding="0" cellspacing="0">
								<tr>
									<th width="15%">#{msgs.label_contactNumber}</th>
									<td width="20%">
										<h:inputText styleClass="form-control" disabled="true" value="#{guidanceReq.followUp.contactNumber}" style="width: 75%;margin-left: 5px;" />
									</td>

								</tr>
							</table>
						</h:panelGroup>
					</td>
				</tr>

				<tr>
					<td width="100%" height="5" />
				</tr>

				<tr>
					<td>
						<p:accordionPanel id="followUpInformationPanelId" multiple="true" activeIndex="-1">
							<p:tab title="#{msgs.label_currentFollowUpData}">
								<table class="sectionContent" border="0" cellpadding="0" cellspacing="0">
									<tr>
										<th width="15%">#{msgs.label_theCode}</th>
										<td width="20%">
											<h:inputText disabled="true" styleClass="form-control" id="codeId" value="#{guidanceReq.followUp.code}" />
										</td>

										<th width="15%">#{msgs.label_followUpDataSource}</th>
										<td width="20%">
											<h:selectOneMenu disabled="true" styleClass="form-control" value="#{guidanceReq.followUp.domainIdDataSource}">
												<f:selectItem itemValue="#{null}" itemLabel=" " />
												<f:selectItems value="#{guidanceReq.dataSourceDomainList}" var="dataSource" itemLabel="#{dataSource.description}" itemValue="#{dataSource.id}" />
											</h:selectOneMenu>
										</td>

									</tr>

									<tr>
										<th width="15%">#{msgs.label_followUpStartDate}</th>
										<td width="20%">
											<h:inputText id="startDateId" disabled="true" value="#{guidanceReq.followUp.followUpStartDateString}" />
										</td>

										<th width="15%" rowspan="2">#{msgs.label_followUpCoordinates}</th>
										<td width="20%" rowspan="2">
											<code:coordinates disabled="true" latitude="#{guidanceReq.followUp.coordinateLatitude}" longitude="#{guidanceReq.followUp.coordinateLongitude}" />
										</td>
									</tr>

									<tr>
										<th width="15%">#{msgs.label_followUpEndDate}</th>
										<td width="20%">
											<h:inputText disabled="true" styleClass="form-control" id="endDateStrId" value="#{guidanceReq.followUp.followUpEndDateString}" />
										</td>
									</tr>

									<tr>
										<th width="15%">#{msgs.label_followUpCaseType}</th>
										<td width="20%">
											<h:selectOneMenu disabled="true" styleClass="form-control" value="#{guidanceReq.followUp.domainIdCasesType}">
												<f:selectItem itemValue="#{null}" itemLabel=" " />
												<f:selectItems value="#{guidanceReq.casesTypeDomainList}" var="casesType" itemLabel="#{casesType.description}" itemValue="#{casesType.id}" />
											</h:selectOneMenu>
										</td>

										<th width="15%">#{msgs.label_followUpDirect}</th>
										<td width="20%">
											<h:selectBooleanCheckbox disabled="true" value="#{guidanceReq.followUp.directFlag}" />
										</td>
									</tr>

									<tr>
										<th width="15%">#{msgs.label_ghostType}</th>
										<td width="20%">
											<h:inputText id="empId" disabled="true" value="#{msgs.label_employeeTitle}" rendered="#{guidanceReq.followUp.ghostType == guidanceReq.employeeType}" />
											<h:inputText id="nonEmpId" disabled="true" value="#{msgs.label_nonEmployee}" rendered="#{guidanceReq.followUp.ghostType == guidanceReq.nonEmployeeType}" />
										</td>

										<th width="15%">#{msgs.label_followUpEquipmentType}</th>
										<td width="20%">
											<h:selectOneMenu disabled="true" styleClass="form-control" value="#{guidanceReq.followUp.domainIdEquipmentType}">
												<f:selectItem itemValue="#{null}" itemLabel=" " />
												<f:selectItems value="#{guidanceReq.equipmentDomainList}" var="equipmentType" itemLabel="#{equipmentType.description}" itemValue="#{equipmentType.id}" />
											</h:selectOneMenu>
										</td>
									</tr>

									<tr>
										<th width="15%">#{msgs.label_socialId}</th>
										<td width="20%">
											<h:inputText id="employeeIdentityId" disabled="true" value="#{guidanceReq.followUp.employeeSocialId}" rendered="#{guidanceReq.followUp.ghostType == guidanceReq.employeeType}" />
											<h:inputText styleClass="form-control" disabled="true" id="nonEmployeeIdentityId" value="#{guidanceReq.followUp.nonEmployeeSocialId}" rendered="#{guidanceReq.followUp.ghostType == guidanceReq.nonEmployeeType}" />
										</td>
									</tr>

									<tr>
										<th width="15%">#{msgs.label_aliasName}</th>
										<td width="20%">
											<h:inputText disabled="true" styleClass="form-control" id="aliasNameId" value="#{guidanceReq.followUp.aliasName}" />
										</td>


										<th width="15%">
											<h:outputText value="#{msgs.label_employeeTitle}" rendered="#{guidanceReq.followUp.ghostType == guidanceReq.employeeType}" />
											<h:outputText value="#{msgs.label_nonEmployeeName}" rendered="#{guidanceReq.followUp.ghostType == guidanceReq.nonEmployeeType}" />
										</th>
										<td width="20%">
											<h:inputText id="employeeNameId" disabled="true" styleClass="form-control" value="#{guidanceReq.followUp.employeeName}" rendered="#{guidanceReq.followUp.ghostType == guidanceReq.employeeType}" />
											<h:inputText styleClass="form-control" disabled="true" id="nonEmployeeNameId" value="#{guidanceReq.followUp.nonEmployeeName}" rendered="#{guidanceReq.followUp.ghostType == guidanceReq.nonEmployeeType}" />
										</td>

									</tr>

									<tr>
										<th width="15%">#{msgs.label_region}</th>
										<td width="20%">
											<h:selectOneMenu disabled="true" styleClass="form-control" value="#{guidanceReq.followUp.regionId}">
												<f:selectItem itemValue="" itemLabel=" " />
												<f:selectItems value="#{guidanceReq.regionsList}" var="region" itemLabel="#{region.regionName}" itemValue="#{region.id}" />
											</h:selectOneMenu>
										</td>

										<th width="15%">
											<h:outputText value="#{msgs.label_sector}" rendered="#{not empty followUpReg.sectorsList}" />
										</th>
										<td width="20%">
											<h:selectOneMenu disabled="true" styleClass="form-control" value="#{guidanceReq.followUp.sectorId}" rendered="#{not empty followUpReg.sectorsList}">
												<f:selectItem itemValue="" itemLabel=" " />
												<f:selectItems value="#{guidanceReq.sectorsList}" var="sector" itemLabel="#{sector.arabicName}" itemValue="#{sector.id}" />
											</h:selectOneMenu>
										</td>
									</tr>

								</table>
							</p:tab>

							<p:tab title="#{msgs.title_conversationMainData}">
								<table class="sectionContent" border="0" cellpadding="0" cellspacing="0">
									<tr>
										<th width="15%">#{msgs.label_conversationType}</th>
										<td width="20%">
											<h:selectOneRadio disabled="true" value="#{guidanceReq.conversation.conversationType}">
												<f:selectItem itemLabel="#{msgs.label_direct}" itemValue="#{guidanceReq.convDirectType}" />
												<f:selectItem itemLabel="#{msgs.label_injection}" itemValue="#{guidanceReq.convInjectType}" />
											</h:selectOneRadio>
										</td>
										<th width="15%" rowspan="2">#{msgs.label_conversationCoordinates}</th>
										<td width="20%" rowspan="2">
											<code:coordinates disabled="true" latitude="#{guidanceReq.conversation.coordinateLatitude}" longitude="#{guidanceReq.conversation.coordinateLongitude}" />
										</td>
									</tr>

									<tr>
										<th width="15%">#{msgs.label_conversationDate}</th>
										<td width="20%">
											<h:inputText disabled="true" value="#{guidanceReq.conversation.conversationDateString}" />
										</td>
									</tr>

									<tr>
										<th width="15%">#{msgs.label_conversationTime}</th>
										<td width="20%">
											<h:inputText disabled="true" value="#{guidanceReq.conversation.conversationTime}" />
										</td>
										<th width="15%">#{msgs.label_conversationLocation}</th>
										<td width="20%">
											<h:inputTextarea disabled="true" value="#{guidanceReq.conversation.conversationLocation}" />
										</td>
									</tr>
								</table>
							</p:tab>

							<p:tab title="#{msgs.title_conversationDetails}">
								<h:panelGroup id="conversationDetailsPanelId">
									<p:dataTable reflow="true" tableStyle="table-layout: auto" paginator="true" var="party" value="#{guidanceReq.conversationPartyList}" widgetVar="conversationParty">
										<p:column style="text-align: center;">
											<f:facet name="header"> # </f:facet>
	                                		#{index + 1}
	                            		</p:column>

										<p:column styleClass='centerText' headerText="#{msgs.label_contactNumber}">
											<h:outputText value="#{party.contactNumber}" />
										</p:column>

										<p:column styleClass='centerText' headerText="#{msgs.label_name}">
											<h:outputText value="#{party.name}" />
										</p:column>

										<p:column styleClass='centerText' headerText="#{msgs.label_theCode}">
											<h:outputText value="#{party.followUpCode}" />
										</p:column>

										<p:column styleClass='centerText' headerText="#{msgs.label_networkRole}">
											<h:outputText value="#{party.domainIdNetworkRolesDesc}" />
										</p:column>
									</p:dataTable>
								</h:panelGroup>
								<table class="sectionContent" border="0" cellpadding="0" cellspacing="0">
									<tr>
										<th width="15%">#{msgs.label_conversationResult}</th>
										<td width="20%">
											<h:selectOneMenu disabled="true" value="#{guidanceReq.conversation.conversationResult}">
												<f:selectItem itemLabel="#{msgs.label_all}" itemValue="#{null}" noSelectionOption="true" />
												<f:selectItem itemLabel="#{msgs.label_conversationNoResults}" itemValue="#{followUpDetails.convNoResultType}" />
												<f:selectItem itemLabel="#{msgs.label_positive}" itemValue="#{followUpDetails.convPosResultType}" />
												<f:selectItem itemLabel="#{msgs.label_negative}" itemValue="#{followUpDetails.convNegResultType}" />
											</h:selectOneMenu>
										</td>
									</tr>

									<tr>
										<th width="15%">#{msgs.title_conversationDetails}</th>
										<td>
											<h:inputTextarea disabled="true" value="#{guidanceReq.conversation.conversationDetails}" />
										</td>
									</tr>
								</table>
							</p:tab>

							<p:tab title="#{msgs.title_conversationDetails}">
								<table class="sectionContent" border="0" cellpadding="0" cellspacing="0">
									<tr>
										<th width="15%">#{msgs.label_conversationProcessType}</th>
										<td width="20%">
											<h:selectOneMenu disabled="true" styleClass="form-control" value="#{guidanceReq.conversation.domainIdChatAction}">
												<f:selectItem itemValue="#{null}" itemLabel=" " />
												<f:selectItems value="#{guidanceReq.chatActionsDomainList}" var="chatAct" itemLabel="#{chatAct.description}" itemValue="#{chatAct.id}" />
											</h:selectOneMenu>
										</td>
										<td width="20%">
											<table class="actionsSection">
												<tr>
													<td>
														<h:commandButton action="#{guidanceReq.openReminderDialog()}" value="&#xf0f3; &nbsp; #{msgs.label_reminderData}" styleClass="btn btn-default">
															<f:ajax execute="@this" render="formId:reminderDetailsDialogId" onevent="function(event){if(event.status == 'success')PF('reminderDialog').show();} ">
															</f:ajax>
														</h:commandButton>
													</td>
												</tr>
											</table>
										</td>
									</tr>

									<tr>
										<th width="15%">#{msgs.label_taskAction}</th>
										<td>
											<h:inputTextarea disabled="true" value="#{guidanceReq.conversation.actionTaken}" />
										</td>
									</tr>

									<tr>
										<td width="100%" height="5" />
									</tr>

									<tr>
										<td>
											<table class="sectionTitle" border="0" cellpadding="0" cellspacing="0">
												<tr>
													<td>
														<h:outputText value="#{msgs.label_referrals}" />
													</td>
												</tr>
											</table>
										</td>
									</tr>

								</table>
								<h:panelGroup id="referralDetailsPanelId">
									<p:dataTable reflow="true" tableStyle="table-layout: auto" paginator="true" var="referral" value="#{guidanceReq.referralList}" widgetVar="referralWid">
										<p:column style="text-align: center;">
											<f:facet name="header"> # </f:facet>
	                                		#{index + 1}
	                            		</p:column>

										<p:column styleClass='centerText' filterBy="#{referral.domainIdReferralType}" headerText="#{msgs.label_referralType}" filterMatchMode="exact">
											<f:facet name="filter">
												<p:selectOneMenu onchange="PF('referralWid').filter()" style="width:100%">
													<f:selectItem itemLabel="#{msgs.label_all}" itemValue="#{null}" noSelectionOption="true" />
													<f:selectItems var="referralType" itemLabel="#{referralType.description}" itemValue="#{referralType.id}" value="#{guidanceReq.referralDomainList}" />
												</p:selectOneMenu>
											</f:facet>
											<h:outputText value="#{referral.domainIdReferralTypeDesc}" />
										</p:column>

										<p:column styleClass='centerText' filterBy="#{referral.employeeName}" headerText="#{msgs.label_selectedEmployee}" filterMatchMode="contains">
											<h:outputText value="#{referral.employeeName}" />
										</p:column>

										<p:column styleClass='centerText' filterBy="#{referral.details}" headerText="#{msgs.label_description}" filterMatchMode="contains">
											<h:outputText value="#{referral.details}" />
										</p:column>
									</p:dataTable>
								</h:panelGroup>
							</p:tab>
						</p:accordionPanel>
					</td>
				</tr>

				<tr>
					<td width="100%" height="5" />
				</tr>

				<tr>
					<td>
						<table class="actionsSection">
							<tr>
								<td>
									<h:commandButton value="&#xf086; #{msgs.label_otherConversations}" styleClass="btn btn-trans-icon" title="#{msgs.label_view}" onclick="this.form.target='_blank'" action="#{guidanceReq.viewOtherConversations()}" />
								</td>
							</tr>
						</table>
					</td>
				</tr>

				<tr>
					<td width="100%" height="5" />
				</tr>

				<tr>
					<td>
						<h:panelGroup id="followUpTitleId">
							<h:panelGroup rendered="#{followUpDetails.followUp.contactNumber != null}">
								<table class="sectionTitle" border="0" cellpadding="0" cellspacing="0">
									<tr>
										<td>
											<h:outputText value="#{msgs.label_guidanceData}" />
										</td>
									</tr>
								</table>
							</h:panelGroup>
						</h:panelGroup>
					</td>
				</tr>

				<tr>
					<td width="100%" height="5" />
				</tr>
				<tr>
					<td>
						<h:panelGroup id="guidanceDataContainerId">
							<table class="sectionContent" border="0" cellpadding="0" cellspacing="0">
								<tr>
									<th width="15%">
										#{msgs.label_guidanceType}
										<h:outputText rendered="#{guidanceReq.role != 'Notification' and guidanceReq.role != 'History'}" value="*" style="color:red;" />
									</th>
									<td width="20%">
										<h:selectOneMenu disabled="#{guidanceReq.role == 'Notification' or guidanceReq.role == 'History'}" styleClass="form-control" value="#{guidanceReq.guidanceRequest.domainIdGuidanceTypes}">
											<f:selectItem itemValue="#{null}" itemLabel=" " />
											<f:selectItems value="#{guidanceReq.guidanceTypesDomainList}" var="guidanceType" itemLabel="#{guidanceType.description}" itemValue="#{guidanceType.id}" />
										</h:selectOneMenu>
									</td>
								</tr>

								<tr>
									<th width="15%">
										#{msgs.label_guidanceDetails}
										<h:outputText value="*" style="color:red;" />
									</th>
									<td width="20%">
										<h:inputTextarea disabled="#{guidanceReq.role == 'Notification' or guidanceReq.role == 'History'}" styleClass="form-control" value="#{guidanceReq.guidanceRequest.guidanceDetails}" />
									</td>
								</tr>
							</table>
						</h:panelGroup>
					</td>
				</tr>

				<tr>
					<td width="100%" height="5" />
				</tr>

				<tr>
					<td>
						<table class="actionsSection">
							<tr>
								<td>
									<h:commandButton rendered="#{guidanceReq.role != 'Notification' and guidanceReq.role != 'History'}" class="btn btn-success" value="&#xf1d8; #{msgs.label_saveAndSend}" action="#{guidanceReq.saveGuidanceRequest()}" onclick="return confirm('#{msgs.q_confirm}');">
										<f:ajax execute="formId:guidanceDataContainerId" render="formId:notifyMessagesId" onevent="expandClassificationTypeFieldSet" />
									</h:commandButton>
								</td>
							</tr>
						</table>
					</td>
				</tr>
			</table>

			<h:panelGroup id="reminderDetailsDialogId">
				<p:dialog widgetVar="reminderDialog" modal="true" header="#{msgs.label_reminderData}" dir="#{msgs.dir}" id="reminderDetailsId" height="180px;" width="720px">
					<h:panelGroup id="reminderPanelId">
						<table width="100%">
							<tr>
								<td>
									<p:dataTable reflow="true" tableStyle="table-layout: auto" paginator="true" var="reminder" value="#{guidanceReq.reminderList}" widgetVar="reminderWid">
										<p:column style="text-align: center;">
											<f:facet name="header"> # </f:facet>
	                                		#{index + 1}
	                            		</p:column>

										<p:column styleClass='centerText' headerText="#{msgs.label_reminderDate}">
											<h:outputText value="#{reminder.reminderDateString}" />
										</p:column>

										<p:column styleClass='centerText' headerText="#{msgs.label_reminderTime}">
											<h:outputText value="#{reminder.reminderTime}" />
										</p:column>

										<p:column styleClass='centerText' headerText="#{msgs.label_reminderDetails}">
											<h:outputText value="#{reminder.reminderDetails}" />
										</p:column>
									</p:dataTable>
								</td>
							</tr>
						</table>
					</h:panelGroup>
				</p:dialog>
			</h:panelGroup>
		</ui:decorate>
	</h:form>
</h:body>
</html>