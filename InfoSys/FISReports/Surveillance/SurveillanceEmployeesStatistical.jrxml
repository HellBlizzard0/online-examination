<?xml version="1.0" encoding="UTF-8"?>
<jasperReport xmlns="http://jasperreports.sourceforge.net/jasperreports" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:schemaLocation="http://jasperreports.sourceforge.net/jasperreports http://jasperreports.sourceforge.net/xsd/jasperreport.xsd" name="SurveillanceEmployeesStatistical" pageWidth="595" pageHeight="842" whenNoDataType="AllSectionsNoDetail" columnWidth="555" leftMargin="20" rightMargin="20" topMargin="20" bottomMargin="20" uuid="66244e2c-e31d-4460-b1f9-81a03aed4391">
	<property name="ireport.zoom" value="1.5"/>
	<property name="ireport.x" value="0"/>
	<property name="ireport.y" value="51"/>
	<style name="table">
		<box>
			<pen lineWidth="1.0" lineColor="#000000"/>
		</box>
	</style>
	<style name="table_TH" mode="Opaque" backcolor="#C3CFD9">
		<box>
			<pen lineWidth="0.5" lineColor="#000000"/>
		</box>
	</style>
	<style name="table_CH" mode="Opaque" backcolor="#E6F3FF">
		<box>
			<pen lineWidth="0.5" lineColor="#000000"/>
		</box>
	</style>
	<style name="table_TD" mode="Opaque" backcolor="#FFFFFF">
		<box>
			<pen lineWidth="0.5" lineColor="#000000"/>
		</box>
	</style>
	<subDataset name="Table Dataset 1" uuid="0c47bbd3-7d02-48d8-9489-6518de8d9033"/>
	<parameter name="P_REPORTS_ROOT" class="java.lang.String">
		<defaultValueExpression><![CDATA["C://BGReports//FISReports//"]]></defaultValueExpression>
	</parameter>
	<parameter name="P_HIJRI_SYS_DATE" class="java.lang.String"/>
	<parameter name="P_FROM_DATE" class="java.lang.String"/>
	<parameter name="P_TO_DATE" class="java.lang.String"/>
	<parameter name="P_FROM_DATE_NULL" class="java.lang.Integer"/>
	<parameter name="P_TO_DATE_NULL" class="java.lang.Integer"/>
	<parameter name="P_REGION_ID" class="java.lang.Long"/>
	<parameter name="P_SURVEILLANCE_STATUS" class="java.lang.Integer"/>
	<parameter name="P_REGION_NAME" class="java.lang.String"/>
	<parameter name="P_LOGIN_EMPLOYEE_NAME" class="java.lang.String"/>
	<parameter name="P_TOTAL_FROM" class="java.lang.Integer"/>
	<parameter name="P_TOTAL_TO" class="java.lang.Integer"/>
	<parameter name="P_SCHEMA_NAME" class="java.lang.String">
		<defaultValueExpression><![CDATA["INFOSYS"]]></defaultValueExpression>
	</parameter>
	<queryString>
		<![CDATA[select count(rec.ID) COUNT, rec.REGION, rec.STATUS
from (SELECT
se.ID,
(select d.ARABIC_NAME from $P!{P_SCHEMA_NAME}.STP_VW_DEPARTMENTS d WHERE d.ID = se.REGION_ID )REGION,
(
CASE
 WHEN se.WF_INSTANCES_STATUS = 3 and se.END_DATE >= $P!{P_SCHEMA_NAME}.PKG_CHAR_TO_DATE($P{P_HIJRI_SYS_DATE}, 'MI/MM/YYYY') THEN 1
 WHEN se.WF_INSTANCES_STATUS = 3 and se.END_DATE < $P!{P_SCHEMA_NAME}.PKG_CHAR_TO_DATE($P{P_HIJRI_SYS_DATE}, 'MI/MM/YYYY') THEN 0
 ELSE 2
END
)AS STATUS
FROM $P!{P_SCHEMA_NAME}.FIS_VW_SURVEILLANC_EMP_NON_EMP se
where
($P{P_FROM_DATE_NULL} = 1 OR $P!{P_SCHEMA_NAME}.PKG_CHAR_TO_DATE($P{P_FROM_DATE}, 'MI/MM/YYYY') <= se.ORDER_DATE) AND
($P{P_TO_DATE_NULL} = 1 OR $P!{P_SCHEMA_NAME}.PKG_CHAR_TO_DATE($P{P_TO_DATE}, 'MI/MM/YYYY')   > se.ORDER_DATE) AND
($P{P_REGION_ID} = -1 OR se.REGION_ID= $P{P_REGION_ID}) AND
(
   $P{P_SURVEILLANCE_STATUS} = -1 OR
  ($P{P_SURVEILLANCE_STATUS} = 1 AND se.WF_INSTANCES_STATUS = 3 AND
   se.END_DATE >= $P!{P_SCHEMA_NAME}.PKG_CHAR_TO_DATE($P{P_HIJRI_SYS_DATE},   'MI/MM/YYYY') )
   OR
  ($P{P_SURVEILLANCE_STATUS} = 0 AND se.WF_INSTANCES_STATUS = 3 AND
   se.END_DATE < $P!{P_SCHEMA_NAME}.PKG_CHAR_TO_DATE($P{P_HIJRI_SYS_DATE}, 'MI/MM/YYYY') )
  OR
  ($P{P_SURVEILLANCE_STATUS} = 2 AND (se.WF_INSTANCES_STATUS is null or se.WF_INSTANCES_STATUS <> 3) )
) AND
(($P{P_TOTAL_FROM} = -1 AND $P{P_TOTAL_TO} = -1)
OR
EXISTS (
select sr.TOTAL, sr.ID
from $P!{P_SCHEMA_NAME}.FIS_SURVEILLANCE_REPORTS sr
where sr.SURVEILLANCE_EMPLOYEES_ID = se.ID
and sr.STRAT_DATE = (select max(sr2.STRAT_DATE)
  from $P!{P_SCHEMA_NAME}.FIS_SURVEILLANCE_REPORTS sr2
  where sr2.SURVEILLANCE_EMPLOYEES_ID = se.ID)
and sr.TOTAL <> 0
and ($P{P_TOTAL_FROM} = -1 or sr.TOTAL >= $P{P_TOTAL_FROM})
and ($P{P_TOTAL_TO} = -1 or sr.TOTAL <= $P{P_TOTAL_TO})))
) rec
group by REGION, STATUS
order by REGION]]>
	</queryString>
	<field name="COUNT" class="java.lang.Integer"/>
	<field name="REGION" class="java.lang.String"/>
	<field name="STATUS" class="java.lang.Integer"/>
	<variable name="TABLE_INDEX" class="java.lang.Integer" calculation="Count">
		<variableExpression><![CDATA[$V{REPORT_COUNT}]]></variableExpression>
		<initialValueExpression><![CDATA[1]]></initialValueExpression>
	</variable>
	<background>
		<band splitType="Stretch"/>
	</background>
	<pageHeader>
		<band height="148" splitType="Stretch">
			<staticText>
				<reportElement mode="Transparent" x="389" y="3" width="166" height="78" forecolor="#000000" backcolor="#FFFFFF" uuid="c7e76e3e-7953-4b93-b1a9-0ecbe18bc2a4"/>
				<textElement textAlignment="Center" verticalAlignment="Middle" rotation="None" markup="none">
					<font fontName="Arial" size="12" isBold="true" isItalic="false" isUnderline="false" isStrikeThrough="false" pdfEncoding="Identity-H" isPdfEmbedded="true"/>
					<paragraph lineSpacing="Single"/>
				</textElement>
				<text><![CDATA[المملكة العربية السعودية
وزارة الداخلية
المديرية العامة لحرس الحدود
الإدارة العامة للأمن و الاستخبارات
إدارة الاستخبارات
]]></text>
			</staticText>
			<staticText>
				<reportElement mode="Transparent" x="204" y="51" width="166" height="30" forecolor="#000000" backcolor="#FFFFFF" uuid="46e91f8c-57d2-4ee3-a24d-1ff45ddd68da"/>
				<textElement textAlignment="Center" verticalAlignment="Middle" rotation="None" markup="none">
					<font fontName="Arial" size="10" isBold="true" isItalic="false" isUnderline="false" isStrikeThrough="false" pdfEncoding="Identity-H" isPdfEmbedded="true"/>
					<paragraph lineSpacing="Single"/>
				</textElement>
				<text><![CDATA[سري غير قابل للتداول
فقط للمختصين]]></text>
			</staticText>
			<image>
				<reportElement x="263" y="2" width="71" height="46" uuid="2e9589fc-e45d-4cb3-a3fc-c8842116cbee"/>
				<imageExpression><![CDATA[$P{P_REPORTS_ROOT} + "//Images//u5.jpg"]]></imageExpression>
			</image>
			<textField>
				<reportElement x="71" y="92" width="402" height="15" uuid="0cc0435f-8395-46de-b213-da46f27fe42a"/>
				<textElement textAlignment="Center" verticalAlignment="Middle">
					<font fontName="Arial" pdfEncoding="Identity-H"/>
				</textElement>
				<textFieldExpression><![CDATA["تقرير احصائى بالأفراد الذين تم إجراء المراقبة الأمنية لهم خلال فترة من " +($P{P_FROM_DATE_NULL} == 1 ? "" : $P{P_FROM_DATE} )+ " هــ إلي "+($P{P_TO_DATE_NULL} == 1 ? "" : $P{P_TO_DATE} )+" هــ"]]></textFieldExpression>
			</textField>
			<textField pattern="" isBlankWhenNull="false">
				<reportElement mode="Transparent" x="234" y="107" width="100" height="16" forecolor="#000000" backcolor="#FFFFFF" uuid="37607cee-e872-4621-8249-4b1424391c5c"/>
				<textElement textAlignment="Right" verticalAlignment="Middle" rotation="None" markup="none">
					<font fontName="Arial" size="10" isBold="false" isItalic="false" isUnderline="false" isStrikeThrough="false" pdfEncoding="Identity-H" isPdfEmbedded="false"/>
					<paragraph lineSpacing="Single"/>
				</textElement>
				<textFieldExpression><![CDATA["من منطقة "+ ($P{P_REGION_NAME}.equals("-1") ? "" : $P{P_REGION_NAME} )]]></textFieldExpression>
			</textField>
			<textField evaluationTime="Report" pattern="" isBlankWhenNull="false">
				<reportElement mode="Transparent" x="77" y="19" width="40" height="20" forecolor="#000000" backcolor="#FFFFFF" uuid="5118091a-2db1-4370-aafd-51b9a6b0225b"/>
				<textElement textAlignment="Right" verticalAlignment="Middle" rotation="None" markup="none">
					<font fontName="Arial" size="10" isBold="false" isItalic="false" isUnderline="false" isStrikeThrough="false" pdfEncoding="Identity-H" isPdfEmbedded="false"/>
					<paragraph lineSpacing="Single"/>
				</textElement>
				<textFieldExpression><![CDATA[" " + $V{PAGE_NUMBER}]]></textFieldExpression>
			</textField>
			<staticText>
				<reportElement mode="Transparent" x="117" y="39" width="54" height="15" forecolor="#000000" backcolor="#FFFFFF" uuid="a72d4bcc-39ed-4058-bd3f-a665088a143d"/>
				<textElement textAlignment="Center" verticalAlignment="Middle" rotation="None" markup="none">
					<font fontName="Arial" size="10" isBold="false" isItalic="false" isUnderline="false" isStrikeThrough="false" pdfFontName="com/code/resources/reports/arial.ttf" pdfEncoding="Identity-H" isPdfEmbedded="false"/>
					<paragraph lineSpacing="Single"/>
				</textElement>
				<text><![CDATA[الـتـاريـــخ :]]></text>
			</staticText>
			<staticText>
				<reportElement mode="Transparent" x="117" y="0" width="54" height="20" forecolor="#000000" backcolor="#FFFFFF" uuid="ba19d3f4-b8e1-476e-956b-55fa893a0f59"/>
				<textElement textAlignment="Center" verticalAlignment="Middle" rotation="None" markup="none">
					<font fontName="Arial" size="10" isBold="false" isItalic="false" isUnderline="false" isStrikeThrough="false" pdfEncoding="Identity-H" isPdfEmbedded="false"/>
					<paragraph lineSpacing="Single"/>
				</textElement>
				<text><![CDATA[المستخدم :]]></text>
			</staticText>
			<textField evaluationTime="Report" pattern="" isBlankWhenNull="false">
				<reportElement mode="Transparent" x="0" y="0" width="117" height="20" forecolor="#000000" backcolor="#FFFFFF" uuid="eaca682b-96ec-433b-88a7-9a6eb704ea37"/>
				<textElement textAlignment="Right" verticalAlignment="Middle" rotation="None" markup="none">
					<font fontName="Arial" size="10" isBold="false" isItalic="false" isUnderline="false" isStrikeThrough="false" pdfEncoding="Identity-H" isPdfEmbedded="false"/>
					<paragraph lineSpacing="Single"/>
				</textElement>
				<textFieldExpression><![CDATA[$P{P_LOGIN_EMPLOYEE_NAME}]]></textFieldExpression>
			</textField>
			<textField pattern="" isBlankWhenNull="false">
				<reportElement mode="Transparent" x="117" y="19" width="54" height="20" forecolor="#000000" backcolor="#FFFFFF" uuid="b0e834ea-e401-403d-a0c0-9902471c49d4"/>
				<textElement textAlignment="Center" verticalAlignment="Middle" rotation="None" markup="none">
					<font fontName="Arial" size="10" isBold="false" isItalic="false" isUnderline="false" isStrikeThrough="false" pdfEncoding="Identity-H" isPdfEmbedded="false"/>
					<paragraph lineSpacing="Single"/>
				</textElement>
				<textFieldExpression><![CDATA["صفحة "+$V{PAGE_NUMBER}+" من"]]></textFieldExpression>
			</textField>
			<textField pattern="" isBlankWhenNull="false">
				<reportElement mode="Transparent" x="66" y="39" width="51" height="15" forecolor="#000000" backcolor="#FFFFFF" uuid="b5b5677e-69e2-41e9-a1e8-2f42b8df4c47"/>
				<textElement textAlignment="Right" verticalAlignment="Middle" rotation="None" markup="none">
					<font fontName="Arial" size="10" isBold="false" isItalic="false" isUnderline="false" isStrikeThrough="false" pdfEncoding="Identity-H" isPdfEmbedded="false"/>
					<paragraph lineSpacing="Single"/>
				</textElement>
				<textFieldExpression><![CDATA[$P{P_HIJRI_SYS_DATE}.substring(6,10)
+"/"+
$P{P_HIJRI_SYS_DATE}.substring(3,5)
+"/"+
$P{P_HIJRI_SYS_DATE}.substring(0,2)
+"هـ"]]></textFieldExpression>
			</textField>
		</band>
	</pageHeader>
	<columnHeader>
		<band height="25" splitType="Stretch">
			<staticText>
				<reportElement mode="Opaque" x="204" y="5" width="330" height="20" forecolor="#000000" backcolor="#CCCCCC" uuid="e290f592-47c7-41e8-a57b-94c0a42baa37"/>
				<box>
					<pen lineWidth="0.5"/>
					<topPen lineWidth="0.5"/>
					<leftPen lineWidth="0.5"/>
					<bottomPen lineWidth="0.5"/>
					<rightPen lineWidth="0.5"/>
				</box>
				<textElement textAlignment="Center" verticalAlignment="Middle" rotation="None" markup="none">
					<font fontName="Arial" size="10" isBold="true" isItalic="false" isUnderline="false" isStrikeThrough="false" pdfEncoding="Identity-H" isPdfEmbedded="true"/>
					<paragraph lineSpacing="Single"/>
				</textElement>
				<text><![CDATA[المنطقة]]></text>
			</staticText>
			<staticText>
				<reportElement mode="Opaque" x="534" y="5" width="19" height="20" forecolor="#000000" backcolor="#CCCCCC" uuid="0b5efefc-1d5e-44d0-a653-40c8badaecd7"/>
				<box topPadding="0" leftPadding="0" bottomPadding="0" rightPadding="0">
					<pen lineWidth="0.5"/>
					<topPen lineWidth="0.5"/>
					<leftPen lineWidth="0.5"/>
					<bottomPen lineWidth="0.5"/>
					<rightPen lineWidth="0.5"/>
				</box>
				<textElement textAlignment="Center" verticalAlignment="Middle" rotation="None" markup="none">
					<font fontName="Arial" size="12" isBold="true" isItalic="false" isUnderline="false" isStrikeThrough="false" pdfEncoding="Identity-H" isPdfEmbedded="true"/>
					<paragraph lineSpacing="Single"/>
				</textElement>
				<text><![CDATA[#]]></text>
			</staticText>
			<staticText>
				<reportElement mode="Opaque" x="87" y="5" width="117" height="20" forecolor="#000000" backcolor="#CCCCCC" uuid="73d2ec61-fd1b-4beb-a3c2-a192425184ae"/>
				<box>
					<pen lineWidth="0.5"/>
					<topPen lineWidth="0.5"/>
					<leftPen lineWidth="0.5"/>
					<bottomPen lineWidth="0.5"/>
					<rightPen lineWidth="0.5"/>
				</box>
				<textElement textAlignment="Center" verticalAlignment="Middle" rotation="None" markup="none">
					<font fontName="Arial" size="10" isBold="true" isItalic="false" isUnderline="false" isStrikeThrough="false" pdfEncoding="Identity-H" isPdfEmbedded="true"/>
					<paragraph lineSpacing="Single"/>
				</textElement>
				<text><![CDATA[حالة المراقبين]]></text>
			</staticText>
			<staticText>
				<reportElement mode="Opaque" x="0" y="5" width="87" height="20" forecolor="#000000" backcolor="#CCCCCC" uuid="233981ea-a8fc-48f0-afb4-2724621b6c1a"/>
				<box>
					<pen lineWidth="0.5"/>
					<topPen lineWidth="0.5"/>
					<leftPen lineWidth="0.5"/>
					<bottomPen lineWidth="0.5"/>
					<rightPen lineWidth="0.5"/>
				</box>
				<textElement textAlignment="Center" verticalAlignment="Middle" rotation="None" markup="none">
					<font fontName="Arial" size="10" isBold="true" isItalic="false" isUnderline="false" isStrikeThrough="false" pdfEncoding="Identity-H" isPdfEmbedded="true"/>
					<paragraph lineSpacing="Single"/>
				</textElement>
				<text><![CDATA[عدد المراقبين]]></text>
			</staticText>
		</band>
	</columnHeader>
	<detail>
		<band height="20" splitType="Stretch">
			<textField pattern="" isBlankWhenNull="false">
				<reportElement mode="Transparent" x="534" y="0" width="19" height="20" forecolor="#000000" backcolor="#FFFFFF" uuid="5aa79d9d-ce36-4ad4-ab2b-df6501810bff"/>
				<box>
					<pen lineWidth="0.5"/>
					<topPen lineWidth="0.5"/>
					<leftPen lineWidth="0.5"/>
					<bottomPen lineWidth="0.5"/>
					<rightPen lineWidth="0.5"/>
				</box>
				<textElement textAlignment="Center" verticalAlignment="Middle" rotation="None" markup="none">
					<font fontName="Arial" size="10" isBold="false" isItalic="false" isUnderline="false" isStrikeThrough="false" pdfEncoding="Cp1252" isPdfEmbedded="false"/>
					<paragraph lineSpacing="Single"/>
				</textElement>
				<textFieldExpression><![CDATA[$V{TABLE_INDEX}]]></textFieldExpression>
			</textField>
			<elementGroup>
				<textField pattern="" isBlankWhenNull="true">
					<reportElement mode="Transparent" x="204" y="0" width="330" height="20" forecolor="#000000" backcolor="#FFFFFF" uuid="3fcd4ec7-540f-456a-8f49-6390f5200e49"/>
					<box>
						<pen lineWidth="0.5"/>
						<topPen lineWidth="0.5"/>
						<leftPen lineWidth="0.5"/>
						<bottomPen lineWidth="0.5"/>
						<rightPen lineWidth="0.5"/>
					</box>
					<textElement textAlignment="Center" verticalAlignment="Middle" rotation="None" markup="none">
						<font fontName="Arial" size="9" isBold="false" isItalic="false" isUnderline="false" isStrikeThrough="false" pdfEncoding="Identity-H" isPdfEmbedded="false"/>
						<paragraph lineSpacing="Single"/>
					</textElement>
					<textFieldExpression><![CDATA[$F{REGION}]]></textFieldExpression>
				</textField>
			</elementGroup>
			<textField pattern="" isBlankWhenNull="true">
				<reportElement mode="Transparent" x="87" y="0" width="117" height="20" forecolor="#000000" backcolor="#FFFFFF" uuid="22b649a7-b586-4f06-af00-638ca519e721"/>
				<box>
					<pen lineWidth="0.5"/>
					<topPen lineWidth="0.5"/>
					<leftPen lineWidth="0.5"/>
					<bottomPen lineWidth="0.5"/>
					<rightPen lineWidth="0.5"/>
				</box>
				<textElement textAlignment="Center" verticalAlignment="Middle" rotation="None" markup="none">
					<font fontName="Arial" size="9" isBold="false" isItalic="false" isUnderline="false" isStrikeThrough="false" pdfEncoding="Identity-H" isPdfEmbedded="false"/>
					<paragraph lineSpacing="Single"/>
				</textElement>
				<textFieldExpression><![CDATA[$F{STATUS}.intValue() == 1 ? "تحت المراقبة" : ($F{STATUS}.intValue() == 0 ? "تم كف المراقبة" : "تحت الاعتماد")]]></textFieldExpression>
			</textField>
			<textField pattern="" isBlankWhenNull="true">
				<reportElement mode="Transparent" x="0" y="0" width="87" height="20" forecolor="#000000" backcolor="#FFFFFF" uuid="c3a44210-2bbc-4b12-8702-31943e3b720c"/>
				<box>
					<pen lineWidth="0.5"/>
					<topPen lineWidth="0.5"/>
					<leftPen lineWidth="0.5"/>
					<bottomPen lineWidth="0.5"/>
					<rightPen lineWidth="0.5"/>
				</box>
				<textElement textAlignment="Center" verticalAlignment="Middle" rotation="None" markup="none">
					<font fontName="Arial" size="9" isBold="false" isItalic="false" isUnderline="false" isStrikeThrough="false" pdfEncoding="Identity-H" isPdfEmbedded="false"/>
					<paragraph lineSpacing="Single"/>
				</textElement>
				<textFieldExpression><![CDATA[$F{COUNT}]]></textFieldExpression>
			</textField>
		</band>
	</detail>
</jasperReport>
